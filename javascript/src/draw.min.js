function drawInit(){require(["dojo/dom","dijit/registry","dojo/_base/lang","dojo/_base/Color","esri/toolbars/draw","esri/graphic","dojo/json","esri/config","esri/map","esri/graphic","esri/geometry/Geometry","esri/geometry/Extent","esri/SpatialReference","esri/tasks/GeometryService","esri/tasks/LengthsParameters","esri/tasks/AreasAndLengthsParameters","esri/layers/FeatureLayer","esri/renderers/SimpleRenderer","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleMarkerSymbol","esri/layers/GraphicsLayer","dijit/form/Select","esri/geometry/Point","esri/geometry/webMercatorUtils"],function(e,t,l,n,a,i,r,d,s,o,m,y,p,c,u,g,b,w,v,I,h,L,E,x,S){function f(e){t.byId("settings_xy_proj").set("value",t.byId("pointUnits").value),t.byId("help_xy_proj").set("value",t.byId("pointUnits").value),"dd"==t.byId("pointUnits").value?(document.getElementById("xyInstruct").innerHTML="Lat N: 40.24567 Long W: 103.24501",document.getElementById("multixyInstruct").innerHTML="40.24,103,39.3456,104.4",document.getElementById("ddDiv").style.display="block",document.getElementById("dmsDiv").style.display="none",document.getElementById("dmDiv").style.display="none",document.getElementById("utmDiv").style.display="none"):"dms"==t.byId("pointUnits").value?(document.getElementById("xyInstruct").innerHTML="Lat N: 41 32 4.267 Long W: 103 20 24.5",document.getElementById("multixyInstruct").innerHTML="41:0:4.267,103:0:3,40:0:0,104:30:2",document.getElementById("ddDiv").style.display="none",document.getElementById("dmsDiv").style.display="block",document.getElementById("dmDiv").style.display="none",document.getElementById("utmDiv").style.display="none"):"dm"==t.byId("pointUnits").value?(document.getElementById("xyInstruct").innerHTML="Lat N: 41 0.345 Long W: 103 20.5",document.getElementById("multixyInstruct").innerHTML="41:0.34,103:0,40:10,104:2.35",document.getElementById("ddDiv").style.display="none",document.getElementById("dmsDiv").style.display="none",document.getElementById("dmDiv").style.display="block",document.getElementById("utmDiv").style.display="none"):(document.getElementById("xyInstruct").innerHTML="Easting: 320000 Northing: 4300000",document.getElementById("multixyInstruct").innerHTML="320000,4300000,400300,4320000",document.getElementById("ddDiv").style.display="none",document.getElementById("dmsDiv").style.display="none",document.getElementById("dmDiv").style.display="none",document.getElementById("utmDiv").style.display="block")}function B(l){var a,i,r=this,d=l.geometry;switch(d.type){case"point":var s,m=new x(d.x,d.y,r.spatialReference);if(labelPoint=new o(m),drawText){drawTextGraphicsLayer=new L,drawTextGraphicsLayer.id="drawtextgraphics"+drawTextGraphicsCounter,drawTextGraphicsCount.push(drawTextGraphicsLayer.id),drawTextGraphicsCounter++,document.getElementById("clearText").style.visibility="visible";var y=t.byId("textStyle").value;s=document.getElementById("drawlabel").value,s=s.replace("&","and"),regexp=/([^a-zA-Z0-9 \-\',\.!_\*()])/g,regexp.test(s)&&alert("Illegal characters were removed from the label.","Warning"),s=s.replace(regexp,""),addLabel(labelPoint,s,drawTextGraphicsLayer,y)}else drawGraphicsLayer=new L,drawGraphicsLayer.id="drawgraphics"+drawGraphicsCounter,drawGraphicsCount.push(drawGraphicsLayer.id),drawGraphicsCounter++,document.getElementById("clearGraphics").style.visibility="visible",addPointSymbol(d),t.byId("labelXY").checked||r.addLayer(drawGraphicsLayer),document.getElementById("measurements").style.visibility="visible",document.getElementById("measurements").style.display="block",e.byId("area").innerHTML="",t.byId("radioLabelCustom").checked&&""!=document.getElementById("customXYlabel").value?(s=document.getElementById("customXYlabel").value,s=s.replace("&","and"),regexp=/([^a-zA-Z0-9 \-\',\.!_\*()])/g,regexp.test(s)&&alert("Illegal characters were removed from the label.","Warning"),s=s.replace(regexp,""),t.byId("labelXY").checked&&addLabel(labelPoint,s,drawGraphicsLayer,"11pt"),"dd"==t.byId("pointUnits").value?(i=S.webMercatorToGeographic(m),s=i.y.toFixed(5)+" N, "+-1*i.x.toFixed(5)+" W",e.byId("length").innerHTML="Lat, Long: "+s):"dm"==t.byId("pointUnits").value?(xy=mappoint_to_dm(m,!1),s=xy[0]+" N, "+xy[1]+" W",e.byId("length").innerHTML="Lat, Long: "+s):"dms"==t.byId("pointUnits").value?(xy=mappoint_to_dms(m,!1),s=xy[0]+" N, "+xy[1]+" W",e.byId("length").innerHTML="Lat, Long: "+s):require(["esri/tasks/ProjectParameters"],function(l){var n=new l;n.geometries=[labelPoint.geometry],n.outSR=new p(Number(t.byId("pointUnits").value)),geometryService.project(n,function(t){s=t[0].x.toFixed(0)+", "+t[0].y.toFixed(0),e.byId("length").innerHTML="UTM: "+s,n=null},function(e){alert("Problem projecting point. "+e.message,"Warning"),n=null})})):"dd"==t.byId("pointUnits").value?(i=S.webMercatorToGeographic(m),s=i.y.toFixed(5)+" N, "+-1*i.x.toFixed(5)+" W",t.byId("labelXY").checked&&addLabel(labelPoint,s,drawGraphicsLayer,"11pt"),e.byId("length").innerHTML="Lat, Long: "+s):"dm"==t.byId("pointUnits").value?(xy=mappoint_to_dm(m,!1),s=xy[0]+" N, "+xy[1]+" W",t.byId("labelXY").checked&&addLabel(labelPoint,s,drawGraphicsLayer,"11pt"),e.byId("length").innerHTML="Lat, Long: "+s):"dms"==t.byId("pointUnits").value?(xy=mappoint_to_dms(m,!1),s=xy[0]+" N, "+xy[1]+" W",t.byId("labelXY").checked&&addLabel(labelPoint,s,drawGraphicsLayer,"11pt"),e.byId("length").innerHTML="Lat, Long: "+s):require(["esri/tasks/ProjectParameters"],function(l){var n=new l;n.geometries=[labelPoint.geometry],n.outSR=new p(Number(t.byId("pointUnits").value)),geometryService.project(n,function(l){s=l[0].x.toFixed(0)+", "+l[0].y.toFixed(0),t.byId("labelXY").checked&&addLabel(labelPoint,s,drawGraphicsLayer,"11pt"),e.byId("length").innerHTML="UTM: "+s,n=null},function(e){alert("Problem projecting point. Can't label point."+e.message,"Warning"),n=null})});break;case"polyline":drawGraphicsLayer=new L,drawGraphicsLayer.id="drawgraphics"+drawGraphicsCounter,drawGraphicsCount.push(drawGraphicsLayer.id),drawGraphicsCounter++,document.getElementById("clearGraphics").style.visibility="visible",t.byId("lineStyle").value.indexOf("blue")>-1?a=new v(v.STYLE_SOLID,new n([0,0,200]),2):t.byId("lineStyle").value.indexOf("green")>-1?a=new v(v.STYLE_SOLID,new n([0,150,5]),2):t.byId("lineStyle").value.indexOf("gray")>-1?a=new v(v.STYLE_SOLID,new n([100,100,100]),2):t.byId("lineStyle").value.indexOf("red")>-1&&(a=new v(v.STYLE_SOLID,new n([255,0,10]),2)),drawGraphicsLayer.add(new o(d,a)),t.byId("labelLine").checked?labelPoint=new o(new x((d.getExtent().xmax-d.getExtent().xmin)/2+d.getExtent().xmin,(d.getExtent().ymax-d.getExtent().ymin)/2+d.getExtent().ymin,r.spatialReference)):r.addLayer(drawGraphicsLayer);var c=new u;c.lengthUnit=t.byId("lineDistCB").value,c.calculationType="geodesic",geometryService.simplify([d],function(e){c.polylines=e,geometryService.lengths(c)});break;case"polygon":drawGraphicsLayer=new L,drawGraphicsLayer.id="drawgraphics"+drawGraphicsCounter,drawGraphicsCount.push(drawGraphicsLayer.id),drawGraphicsCounter++,document.getElementById("clearGraphics").style.visibility="visible",t.byId("fillStyle").value.indexOf("solid blue")>-1?a=new I(I.STYLE_SOLID,new v(v.STYLE_SOLID,new n([0,0,200]),2),new n([0,0,255,.2])):t.byId("fillStyle").value.indexOf("solid green")>-1?a=new I(I.STYLE_SOLID,new v(v.STYLE_SOLID,new n([0,150,5]),2),new n([0,255,0,.1])):t.byId("fillStyle").value.indexOf("solid gray")>-1?a=new I(I.STYLE_SOLID,new v(v.STYLE_SOLID,new n([100,100,100]),2),new n([100,100,1e3,.1])):t.byId("fillStyle").value.indexOf("solid red")>-1?a=new I(I.STYLE_SOLID,new v(v.STYLE_SOLID,new n([255,0,10]),2),new n([255,0,0,.1])):t.byId("fillStyle").value.indexOf("diagonal blue")>-1?a=new I(I.STYLE_BACKWARD_DIAGONAL,new v(v.STYLE_SOLID,new n([0,0,200]),2),new n([0,0,255,1])):t.byId("fillStyle").value.indexOf("diagonal green")>-1?a=new I(I.STYLE_BACKWARD_DIAGONAL,new v(v.STYLE_SOLID,new n([0,150,5]),2),new n([0,255,0,1])):t.byId("fillStyle").value.indexOf("diagonal gray")>-1?a=new I(I.STYLE_BACKWARD_DIAGONAL,new v(v.STYLE_SOLID,new n([100,100,100]),2),new n([100,100,100,1])):t.byId("fillStyle").value.indexOf("diagonal red")>-1&&(a=new I(I.STYLE_BACKWARD_DIAGONAL,new v(v.STYLE_SOLID,new n([255,0,10]),2),new n([255,0,0,1]))),drawGraphicsLayer.add(new o(d,a)),t.byId("labelPoly").checked?labelPoint=new o(new x((d.getExtent().xmax-d.getExtent().xmin)/2+d.getExtent().xmin,d.getExtent().ymin,r.spatialReference)):r.addLayer(drawGraphicsLayer);var b=new g;b.lengthUnit=t.byId("distCB").value,b.areaUnit=t.byId("areaCB").value,b.calculationType="geodesic",geometryService.simplify([d],function(e){b.polygons=e,geometryService.areasAndLengths(b)})}drawExit()}function T(l){var n=l.result;document.getElementById("measurements").style.visibility="visible",document.getElementById("measurements").style.display="block",e.byId("area").innerHTML="";for(var a=0;a<t.byId("lineDistCB").options.length;a++)if(t.byId("lineDistCB").options[a].selected){var i=n.lengths[0].toFixed(1)+" "+t.byId("lineDistCB").options[a].label;e.byId("length").innerHTML=i,t.byId("labelLine").checked&&(t.byId("radioLabelLineCustom").checked&&""!=document.getElementById("customLineLabel").value&&(i=document.getElementById("customLineLabel").value,i=i.replace("&","and"),regexp=/([^a-zA-Z0-9 \-\',\.!_\*()])/g,regexp.test(i)&&alert("Illegal characters were removed from the label.","Warning"),i=i.replace(regexp,"")),addLabel(labelPoint,i,drawGraphicsLayer,"11pt"));break}}function G(l){var n,a,i=l.result;document.getElementById("measurements").style.visibility="visible",document.getElementById("measurements").style.display="block";for(var r=0;r<t.byId("areaCB").options.length;r++)if(t.byId("areaCB").options[r].selected){n=i.areas[0].toFixed(1)+" "+t.byId("areaCB").options[r].label,e.byId("area").innerHTML=n;break}for(r=0;r<t.byId("distCB").options.length;r++)if(t.byId("distCB").options[r].selected){a=i.lengths[0].toFixed(1)+" "+t.byId("distCB").options[r].label,e.byId("length").innerHTML=a;break}t.byId("labelPoly").checked&&(t.byId("radioLabelPolyCustom").checked&&""!=document.getElementById("customPolyLabel").value?(label=document.getElementById("customPolyLabel").value,label=label.replace("&","and"),regexp=/([^a-zA-Z0-9 \-\',\.!_\*()])/g,regexp.test(label)&&alert("Illegal characters were removed from the label.","Warning"),label=label.replace(regexp,""),addLabel(labelPoint,label,drawGraphicsLayer,"11pt")):addLabel(labelPoint,n+" "+a,drawGraphicsLayer,"11pt"))}e.byId("drawDiv").addEventListener("click",function(e){t.byId("drawDiv").open||drawExit()});var C=new E({name:"pointStyle",id:"pointStyle",labelAttr:"label",style:"width:140px",options:[{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/ptsmblue.png'/>small blue",value:"smblue"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/ptsmgreen.png'/>small green",value:"smgreen"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/ptsmgray.png'/>small gray",value:"smgray"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/ptsmred.png'/>small red",value:"smred"},{type:"separator"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/ptmedblue.png'/>medium blue",value:"medblue"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/ptmedgreen.png'/>medium green",value:"medgreen"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/ptmedgray.png'/>medium gray",value:"medgray"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/ptmedred.png'/>medium red",value:"medred"},{type:"separator"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/ptlgblue.png'/>large blue",value:"lgblue"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/ptlggreen.png'/>large green",value:"lggreen"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/ptlggray.png'/>large gray",value:"lggray"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/ptlgred.png'/>large red",value:"lgred"}]},"pointStyleDiv");C.startup(),C.set("value","medblue");var _=new E({name:"pointUnits",id:"pointUnits",labelAttr:"label",options:[{label:"Decimal degrees",value:"dd"},{label:"Degrees, minutes, seconds",value:"dms"},{label:"Degrees, decimal minutes",value:"dm"},{label:"WGS84 UTM Zone 12N",value:"32612"},{label:"WGS84 UTM Zone 13N",value:"32613"},{label:"NAD83 UTM Zone 12N",value:"26912"},{label:"NAD83 UTM Zone 13N",value:"26913"},{label:"NAD27 UTM Zone 12N",value:"26712"},{label:"NAD27 UTM Zone 13N",value:"26713"}]},"pointXYUnits");_.startup(),_.set("value",settings.XYProjection),_.on("change",f);var N=new E({name:"lineStyle",id:"lineStyle",labelAttr:"label",style:"width:95px",options:[{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/blueline.png'/> blue ",value:"blue"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/greenline.png'/> green ",value:"green"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/grayline.png'/> gray ",value:"gray"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/redline.png'/> red ",value:"red"}]},"lineStyleDiv");N.startup();var O=new E({name:"lineDistCB",id:"lineDistCB",labelAttr:"label",options:[{label:"Miles",value:c.UNIT_STATUTE_MILE},{label:"Feet",value:c.UNIT_FOOT},{label:"Kilometers",value:c.UNIT_KILOMETER},{label:"Meters",value:c.UNIT_METER}]},lineLengthDiv);O.startup();var k=new E({name:"fillStyle",id:"fillStyle",labelAttr:"label",options:[{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/solidblue.png'/> solid blue",value:"solid blue"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/solidgreen.png'/> solid green",value:"solid green"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/solidgray.png'/> solid gray",value:"solid gray"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/solidred.png'/> solid red",value:"solid red"},{type:"separator"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/diagonalblue.png'/> diagonal blue",value:"diagonal blue"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/diagonalgreen.png'/> diagonal green",value:"diagonal green"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/diagonalgray.png'/> diagonal gray",value:"diagonal gray"},{label:"<img width='30px' height='30px' align='middle' style='vertical-align:middle;display:inline-block;' src='assets/images/diagonalred.png'/> diagonal red",value:"diagonal red"}]},"fillStyleDiv");k.startup();var D=new E({name:"areaCB",id:"areaCB",labelAttr:"label",options:[{label:"Acres",value:c.UNIT_ACRES},{label:"Square miles",value:c.UNIT_SQUARE_MILES},{label:"Square feet",value:c.UNIT_SQUARE_FEET},{label:"Hectares",value:c.UNIT_HECTARES},{label:"Square kiometers",value:c.UNIT_SQUARE_KILOMETERS},{label:"Square meters",value:c.UNIT_SQUARE_METERS}]},areaDiv);D.startup();var Y=new E({name:"distCB",id:"distCB",labelAttr:"label",options:[{label:"Miles",value:c.UNIT_STATUTE_MILE},{label:"Feet",value:c.UNIT_FOOT},{label:"Kilometers",value:c.UNIT_KILOMETER},{label:"Meters",value:c.UNIT_METER}]},lengthDiv);Y.startup();var P=new E({name:"textStyle",id:"textStyle",labelAttr:"label",options:[{label:"Tiny",value:".55em"},{label:"Small",value:".8em"},{label:"Medium",value:"1em"},{label:"Large",value:"1.2em"},{label:"Larger",value:"1.5em"},{label:"Giant",value:"2.55em"}]},"textStyleDiv");P.startup(),P.set("value","1em");var M=new E({name:"ptMethodCB",id:"ptMethodCB",labelAttr:"label",options:[{label:"Map click",value:"map"},{label:"XY value",value:"xy"},{label:"Multiple XYs",value:"multi"},{label:"Current location",value:"loc"}],onChange:function(){switch(this.attr("value")){case"map":document.getElementById("xyDiv").style.display="none",document.getElementById("multixyDiv").style.display="none",document.getElementById("locationDiv").style.display="none";break;case"xy":document.getElementById("xyDiv").style.display="block",document.getElementById("multixyDiv").style.display="none",document.getElementById("locationDiv").style.display="none";break;case"multi":document.getElementById("xyDiv").style.display="none",document.getElementById("multixyDiv").style.display="block",document.getElementById("locationDiv").style.display="none";break;case"loc":document.getElementById("xyDiv").style.display="none",document.getElementById("multixyDiv").style.display="none",document.getElementById("locationDiv").style.display="block"}}},"ptMethod");M.startup(),toolbar=new a(map,{showTooltips:!0}),toolbar.on("draw-end",l.hitch(map,B)),geometryService.on("areas-and-lengths-complete",G),geometryService.on("lengths-complete",T)})}function addPointSymbol(e){require(["dijit/registry","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleMarkerSymbol","esri/graphic","dojo/_base/Color"],function(t,l,n,a,i){var r;t.byId("pointStyle").value.indexOf("smblue")>-1?r=new n(n.STYLE_CIRCLE,7,new l(l.STYLE_SOLID,new i([0,0,200]),1),new i([0,0,255,.6])):t.byId("pointStyle").value.indexOf("medblue")>-1?r=new n(n.STYLE_CIRCLE,14,new l(l.STYLE_SOLID,new i([0,0,200]),1),new i([0,0,255,.6])):t.byId("pointStyle").value.indexOf("lgblue")>-1?r=new n(n.STYLE_CIRCLE,21,new l(l.STYLE_SOLID,new i([0,0,200]),1),new i([0,0,255,.6])):t.byId("pointStyle").value.indexOf("smgreen")>-1?r=new n(n.STYLE_CIRCLE,7,new l(l.STYLE_SOLID,new i([0,150,5]),1),new i([0,255,0,.6])):t.byId("pointStyle").value.indexOf("medgreen")>-1?r=new n(n.STYLE_CIRCLE,14,new l(l.STYLE_SOLID,new i([0,150,5]),1),new i([0,255,0,.6])):t.byId("pointStyle").value.indexOf("lggreen")>-1?r=new n(n.STYLE_CIRCLE,21,new l(l.STYLE_SOLID,new i([0,150,5]),1),new i([0,255,0,.6])):t.byId("pointStyle").value.indexOf("smgray")>-1?r=new n(n.STYLE_CIRCLE,7,new l(l.STYLE_SOLID,new i([100,100,100]),1),new i([100,100,100,.6])):t.byId("pointStyle").value.indexOf("medgray")>-1?r=new n(n.STYLE_CIRCLE,14,new l(l.STYLE_SOLID,new i([100,100,100]),1),new i([100,100,100,.6])):t.byId("pointStyle").value.indexOf("lggray")>-1?r=new n(n.STYLE_CIRCLE,21,new l(l.STYLE_SOLID,new i([100,100,100]),1),new i([100,100,100,.6])):t.byId("pointStyle").value.indexOf("smred")>-1?r=new n(n.STYLE_CIRCLE,7,new l(l.STYLE_SOLID,new i([255,0,10]),1),new i([255,0,0,.6])):t.byId("pointStyle").value.indexOf("medred")>-1?r=new n(n.STYLE_CIRCLE,14,new l(l.STYLE_SOLID,new i([255,0,10]),1),new i([255,0,0,.6])):t.byId("pointStyle").value.indexOf("lgred")>-1&&(r=new n(n.STYLE_CIRCLE,21,new l(l.STYLE_SOLID,new i([255,0,10]),1),new i([255,0,0,.6]))),drawGraphicsLayer.add(new a(e,r))})}function removeDrawItem(){if(0!=drawGraphicsCount.length){drawGraphicsCounter--;var e=drawGraphicsCount.pop();map.removeLayer(map.getLayer(e)),0==drawGraphicsCount.length&&(document.getElementById("clearGraphics").style.visibility="hidden")}}function removeDrawTextItem(){if(0!=drawTextGraphicsCount.length){drawTextGraphicsCounter--;var e=drawTextGraphicsCount.pop();map.removeLayer(map.getLayer(e)),0==drawTextGraphicsCount.length&&(document.getElementById("clearText").style.visibility="hidden")}}function drawExit(){drawing=!1,drawText=!1,toolbar.deactivate(),map.enableMapNavigation(),document.getElementById("mappoint").className="graphBtn",document.getElementById("polyline").className="graphBtn",document.getElementById("freehandpolyline").className="graphBtn",document.getElementById("extent").className="graphBtn",document.getElementById("polygon").className="graphBtn",document.getElementById("label").className="graphBtn",document.getElementById("pointOptions").style.display="none",document.getElementById("lineOptions").style.display="none",document.getElementById("fillOptions").style.display="none",document.getElementById("drawlabel").value="",document.getElementById("pointsXY").value="",document.getElementById("pointXdd").value="",document.getElementById("pointYdd").value="",document.getElementById("pointXddm").value="",document.getElementById("pointYddm").value="",document.getElementById("pointXmindm").value="",document.getElementById("pointYmindm").value="",document.getElementById("pointXdeg").value="",document.getElementById("pointYdeg").value="",document.getElementById("pointXmin").value="",document.getElementById("pointYmin").value="",document.getElementById("pointXsec").value="",document.getElementById("pointYsec").value="",document.getElementById("pointX").value="",document.getElementById("pointY").value=""}function activateDrawTool(e){"graphBtnSelected"!=e.currentTarget.className?("label"==e.currentTarget.id?("function"==typeof ga&&ga("send","event","label-wayPt","click","Label | Way Point","1"),"function"==typeof gtag&&gtag("event","widget_click",{widget_name:"Label | Way Point"})):("function"==typeof ga&&ga("send","event","draw-measure","click","Draw | Measure","1"),"function"==typeof gtag&&gtag("event","widget_click",{widget_name:"Draw | Measure"})),drawing=!0,map.disableMapNavigation(),e.currentTarget.className="graphBtnSelected","mappoint"!=e.currentTarget.id&&(document.getElementById("mappoint").className="graphBtn"),"polyline"!=e.currentTarget.id&&(document.getElementById("polyline").className="graphBtn"),"freehandpolyline"!=e.currentTarget.id&&(document.getElementById("freehandpolyline").className="graphBtn"),"extent"!=e.currentTarget.id&&(document.getElementById("extent").className="graphBtn"),"polygon"!=e.currentTarget.id&&(document.getElementById("polygon").className="graphBtn"),"label"!=e.currentTarget.id&&(document.getElementById("label").className="graphBtn"),document.getElementById("pointOptions").style.visibility="visible",document.getElementById("lineOptions").style.visibility="visible",document.getElementById("fillOptions").style.visibility="visible",document.getElementById("measurements").style.visibility="hidden",document.getElementById("measurements").style.display="none",require(["esri/toolbars/draw","dojo/i18n!esri/nls/jsapi"],function(t,l){"mappoint"==e.currentTarget.id?(document.getElementById("pointOptions").style.display="block",document.getElementById("lineOptions").style.display="none",document.getElementById("fillOptions").style.display="none",l.toolbars.draw.addPoint="Click to add a way point",toolbar.activate(t.POINT)):"polyline"==e.currentTarget.id?(document.getElementById("pointOptions").style.display="none",document.getElementById("lineOptions").style.display="block",document.getElementById("fillOptions").style.display="none",toolbar.activate(t.POLYLINE)):"freehandpolyline"==e.currentTarget.id?(document.getElementById("pointOptions").style.display="none",document.getElementById("lineOptions").style.display="block",document.getElementById("fillOptions").style.display="none",toolbar.activate(t.FREEHAND_POLYLINE)):"extent"==e.currentTarget.id?(document.getElementById("pointOptions").style.display="none",document.getElementById("lineOptions").style.display="none",document.getElementById("fillOptions").style.display="block",l.toolbars.draw.addShape="Press down to start and let go to finish",toolbar.activate(t.RECTANGLE)):"polygon"==e.currentTarget.id?(document.getElementById("pointOptions").style.display="none",document.getElementById("lineOptions").style.display="none",document.getElementById("fillOptions").style.display="block",toolbar.activate(t.POLYGON)):"label"==e.currentTarget.id&&(document.getElementById("pointOptions").style.display="none",document.getElementById("lineOptions").style.display="none",document.getElementById("fillOptions").style.display="none",l.toolbars.draw.addPoint="Click to add a label",drawText=!0,toolbar.activate(t.POINT))})):drawExit()}function drawPoint(){require(["dojo/dom","dijit/registry","esri/SpatialReference","esri/geometry/Point"],function(e,t,l,n){var a,i,r,d,s,o,m;if("dd"==t.byId("pointUnits").value){if(d=Number(document.getElementById("pointXdd").value),s=Number(document.getElementById("pointYdd").value),d>0&&(d*=-1),!((d>=-110&&d<=-100||d>=100&&d<=110)&&s>=35&&s<=42))return void alert("This point is not in Colorado. Latitude of 35 - 42. Longitude of 100 - 110.","Warning");i=s+" N, "+-1*d+" W",a=new l(4326),r=new n(d,s,a)}else if("dms"==t.byId("pointUnits").value){if(s=Number(document.getElementById("pointYdeg").value)+Number(document.getElementById("pointYmin").value)/60+Number(document.getElementById("pointYsec").value)/3600,d=Number(document.getElementById("pointXdeg").value)+Number(document.getElementById("pointXmin").value)/60+Number(document.getElementById("pointXsec").value)/3600,d>0&&(d*=-1),!((d>=-110&&d<=-100||d>=100&&d<=110)&&s>=35&&s<=42))return void alert("This point is not in Colorado. Latitude of 35 - 42. Longitude of 100 - 110.","Warning");o=Number(document.getElementById("pointXdeg").value),o<0&&(o*=-1),i=document.getElementById("pointYdeg").value+"째 "+Number(document.getElementById("pointYmin").value)+"' "+Number(document.getElementById("pointYsec").value)+'" N, '+o+"째 "+Number(document.getElementById("pointXmin").value)+"' "+Number(document.getElementById("pointXsec").value)+'" W',a=new l(4326),r=new n(d,s,a)}else if("dm"==t.byId("pointUnits").value){if(s=Number(document.getElementById("pointYddm").value)+Number(document.getElementById("pointYmindm").value)/60,d=Number(document.getElementById("pointXddm").value)+Number(document.getElementById("pointXmindm").value)/60,d>0&&(d*=-1),!((d>=-110&&d<=-100||d>=100&&d<=110)&&s>=35&&s<=42))return void alert("This point is not in Colorado. Latitude of 35 - 42. Longitude of 100 - 110.","Warning");o=Number(document.getElementById("pointXddm").value),o<0&&(o*=-1),i=document.getElementById("pointYddm").value+"째 "+Number(document.getElementById("pointYmindm").value)+"' N, "+o+"째 "+Number(document.getElementById("pointXmindm").value)+"' W",a=new l(4326),r=new n(d,s,a)}else{if(d=Number(document.getElementById("pointX").value),s=Number(document.getElementById("pointY").value),!(d>=133e3&&d<=13e5&&s>=4095e3&&s<=458e4))return void alert("This point is not in Colorado. Easting of 133000 - 1300000. Northing of 4095000 - 4580000.","Warning");a=new l(Number(t.byId("pointUnits").value)),i=d+", "+s,r=new n(d,s,a)}m=t.byId("radioLabelCustom").checked&&""!=document.getElementById("customXYlabel").value?document.getElementById("customXYlabel").value:i,projectPointAndLabel(m,r),document.getElementById("measurements").style.visibility="visible",document.getElementById("measurements").style.display="block",e.byId("area").innerHTML="",e.byId("length").innerHTML=i,drawExit(),a=null,r=null})}function projectPointAndLabel(e,t){require(["dojo/dom","dijit/registry","esri/layers/GraphicsLayer","esri/SpatialReference","esri/tasks/GeometryService","esri/tasks/ProjectParameters","esri/graphic"],function(l,n,a,i,r,d,s){params=new d,params.geometries=[t],params.outSR=new i(map.spatialReference),geometryService.project(params,function(t){if(drawGraphicsLayer=new a,drawGraphicsLayer.id="drawgraphics"+drawGraphicsCounter,drawGraphicsCount.push(drawGraphicsLayer.id),drawGraphicsCounter++,document.getElementById("clearGraphics").style.visibility="visible",addPointSymbol(t[0]),n.byId("labelXY").checked){var l=new s(t[0]);addLabel(l,e,drawGraphicsLayer,"11pt"),l=null}else map.addLayer(drawGraphicsLayer);drawGraphicsLayer=null,params=null},function(e){alert("Problem projecting point. "+e.message,"Warning"),params=null})})}function drawMultiPoint(){require(["dojo/dom","dijit/registry","esri/SpatialReference","esri/geometry/Point"],function(e,t,l,n){for(var a,i,r,d,s,o=document.getElementById("pointsXY").value.split(","),m="",y=0;y<o.length;y+=2){if("dd"==t.byId("pointUnits").value){if(s=Number(o[y]),d=Number(o[y+1]),d>0&&(d*=-1),!((d>=-110&&d<=-100||d>=100&&d<=110)&&s>=35&&s<=42))return void alert("This point is not in Colorado. Latitude of 35 - 42. Longitude of 100 - 110.","Warning");i=s+" N, "+-1*d+" W",a=new l(4326),r=new n(d,s,a)}else if("dm"==t.byId("pointUnits").value||"dms"==t.byId("pointUnits").value){var p=dms_or_dm_to_dd(o[y]+","+o[y+1]);if(null==p)return;s=Number(p[0]),d=Number(p[1]),i=p[2],a=new l(4326),r=new n(d,s,a)}else{if(d=Number(o[y]),s=Number(o[y+1]),!(d>=133e3&&d<=13e5&&s>=4095e3&&s<=458e4))return void alert("This point is not in Colorado. Easting of 133000 - 1300000. Northing of 4095000 - 4580000.","Warning");a=new l(Number(t.byId("pointUnits").value)),i=d+", "+s,r=new n(d,s,a)}m+=i+"<br/>",projectPointAndLabel(i,r)}document.getElementById("measurements").style.visibility="visible",document.getElementById("measurements").style.display="block",e.byId("area").innerHTML="",e.byId("length").innerHTML=m,drawExit(),a=null,r=null})}function drawCurrentLocation(){function e(e){require(["dojo/dom","dijit/registry","esri/geometry/Point","esri/SpatialReference","esri/tasks/GeometryService","esri/geometry/webMercatorUtils"],function(t,l,n,a,i,r){var d,s,o=r.geographicToWebMercator(new n(e.coords.longitude,e.coords.latitude));l.byId("radioLabelCustom").checked&&""!=document.getElementById("customXYlabel").value?(d=document.getElementById("customXYlabel").value,d=d.replace("&","and"),regexp=/([^a-zA-Z0-9 \-\',\.!_\*()])/g,regexp.test(d)&&alert("Illegal characters were removed from the label.","Warning"),d=d.replace(regexp,""),"dd"==l.byId("pointUnits").value?(s=e.coords.latitude.toFixed(5)+" N, "+-1*e.coords.longitude.toFixed(5)+" W (plus or minus "+e.coords.accuracy+" meters)",t.byId("length").innerHTML="Lat, Long: "+s,projectPointAndLabel(d,o)):"dm"==l.byId("pointUnits").value?(xy=mappoint_to_dm(o,!1),s=xy[0]+" N, "+xy[1]+" W (plus or minus "+e.coords.accuracy+" meters)",t.byId("length").innerHTML="Lat, Long: "+s,projectPointAndLabel(d,o)):"dms"==l.byId("pointUnits").value?(xy=mappoint_to_dms(o,!1),s=xy[0]+" N, "+xy[1]+" W (plus or minus "+e.coords.accuracy+" meters)",t.byId("length").innerHTML="Lat, Long: "+s,projectPointAndLabel(d,o)):require(["esri/tasks/ProjectParameters"],function(n){var i=new n;i.geometries=[o],i.outSR=new a(Number(l.byId("pointUnits").value)),geometryService.project(i,function(l){s=l[0].x.toFixed(0)+", "+l[0].y.toFixed(0)+" (plus or minus "+e.coords.accuracy+" meters)",t.byId("length").innerHTML="UTM: "+s,projectPointAndLabel(d,o)},function(e){alert("Problem projecting point. "+e.message,"Warning")})})):"dd"==l.byId("pointUnits").value?(d=e.coords.latitude.toFixed(5)+" N, "+-1*e.coords.longitude.toFixed(5)+" W",t.byId("length").innerHTML="Lat, Long: "+d+" (plus or minus "+e.coords.accuracy+" meters)",projectPointAndLabel(d,o)):"dm"==l.byId("pointUnits").value?(xy=mappoint_to_dm(o,!1),d=xy[0]+" N, "+xy[1]+" W",t.byId("length").innerHTML="Lat, Long: "+d+" (plus or minus "+e.coords.accuracy+" meters)",projectPointAndLabel(d,o)):"dms"==l.byId("pointUnits").value?(xy=mappoint_to_dms(o,!1),d=xy[0]+" N, "+xy[1]+" W",
t.byId("length").innerHTML="Lat, Long: "+d+" (plus or minus "+e.coords.accuracy+" meters)",projectPointAndLabel(d,o)):require(["esri/tasks/ProjectParameters"],function(n){var i=new n;i.geometries=[o],i.outSR=new a(Number(l.byId("pointUnits").value)),geometryService.project(i,function(l){d=l[0].x.toFixed(0)+", "+l[0].y.toFixed(0),t.byId("length").innerHTML="UTM: "+d+" (plus or minus "+e.coords.accuracy+" meters)",projectPointAndLabel(d,o),i=null},function(e){alert("Problem projecting point. "+e.message,"Warning"),i=null})}),document.getElementById("measurements").style.visibility="visible",document.getElementById("measurements").style.display="block",t.byId("area").innerHTML=""})}function t(e){switch(e.code){case e.PERMISSION_DENIED:alert("Location not provided. Permission denied.","Warning");break;case e.POSITION_UNAVAILABLE:alert("Current location not available.","Note");break;case e.TIMEOUT:alert("Timeout while getting current location. Please try again.","Note");break;default:alert("Warning: problem while getting current location. "+e.message,"Warning")}}if(navigator.geolocation){drawExit();var l={enableHighAccuracy:!0};navigator.geolocation.getCurrentPosition(e,t,l)}else alert("Your browser doesn't support Geolocation. Visit http://caniuse.com to see browser support for the Geolocation API.","Warning")}function addPoints(e,t){require(["esri/graphic","esri/layers/GraphicsLayer","esri/geometry/Point","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","dojo/_base/Color","esri/geometry/Geometry","esri/SpatialReference"],function(l,n,a,r,d,s,o,m){var y,p,c,u,g,b,w,v=e.split(","),I=/;/g,h=/\\'/g,L=/\\"/g;for(i=0;i<v.length;i++){if(w=v[i].split("|"),drawGraphicsLayer=new n,drawGraphicsLayer.id="drawgraphics"+drawGraphicsCounter,drawGraphicsCount.push(drawGraphicsLayer.id),drawGraphicsCounter++,document.getElementById("clearGraphics").style.visibility="visible",p=null,w.length>=4&&w.length<7)u="s"==w[0]?7:"l"==w[0]?21:14,"b"==w[1]?(g=new s([0,0,255,.6]),b=new s([0,0,200])):"g"==w[1]?(g=new s([0,255,0,.6]),b=new s([0,150,5])):"y"==w[1]?(g=new s([100,100,100,.6]),b=new s([100,100,100])):(g=new s([255,0,0,.6]),b=new s([255,0,10])),y=new r(r.STYLE_CIRCLE,u,new d(d.STYLE_SOLID,b,1),g),w.length>4&&(p=w[4].replace(I,",").replace(h,"'").replace(L,'"')),c=new a(parseFloat(w[2]),parseFloat(w[3]),new m({wkid:wkid}));else{if(!(w.length>6))return void alert("Could not add all of the Way Points. This can happen if a long map URL was emailed.","Note");if(w[4].indexOf("h")>-1){var E=w[2].split(";");E.push(parseFloat(w[3])),g=new s(E),b=new s("#"+w[4].substr(1)),E=null}else g=new s("#"+parseInt(w[2]).toString(16)),b=new s("#"+parseInt(w[4]).toString(16));y=new r(r.STYLE_CIRCLE,w[1],new d(d.STYLE_SOLID,b,1),g),c=new a(parseFloat(w[6]),parseFloat(w[7]),t),w.length>8&&(p=w[8].replace(I,",").replace(h,"'").replace(L,'"'))}if(drawGraphicsLayer.add(new l(c,y)),p){p=p.replace(/~/g," ");var x=new l(c);addLabel(x,p,drawGraphicsLayer,"11pt"),x=null}else map.addLayer(drawGraphicsLayer),drawGraphicsLayer.refresh()}p=null,c=null,y=null,g=null,b=null,v=null,w=null})}function addLines(e,t){require(["esri/graphic","esri/layers/GraphicsLayer","esri/geometry/Polyline","esri/geometry/Point","esri/symbols/SimpleLineSymbol","dojo/_base/Color","esri/geometry/Geometry"],function(l,n,a,r,d,s,o){var m,y,p=e.split(","),c=/;/g,u=/\\'/g,g=/\\"/g;for(i=0;i<p.length;i++){var b;if(m=p[i].split("|"),drawGraphicsLayer=new n,drawGraphicsLayer.id="drawgraphics"+drawGraphicsCounter,drawGraphicsCount.push(drawGraphicsLayer.id),drawGraphicsCounter++,document.getElementById("clearGraphics").style.visibility="visible",m[1].indexOf(";")>-1){var w=m[1].split(";");w[0]=parseInt(w[0]),w[1]=parseInt(w[1]),w[2]=parseInt(w[2]),b=new s(w),w=null}else b=new s("#"+parseInt(m[1]).toString(16));var v,I=new d(d.STYLE_SOLID,b,2),h=[],L=5;for(y=new a(t),j=0;j<m[4];j++){var E=m[L++];for(k=0;k<E;k++)v=[],v.push(parseFloat(m[L++])),v.push(parseFloat(m[L++])),h.push(v),v=null;y.addPath(h),h=null}if(drawGraphicsLayer.add(new l(y,I)),m.length>L){var x=new r(parseFloat(m[L++]),parseFloat(m[L++]),t),S=new l(x),f=m[L++].replace(c,",").replace(u,"'").replace(g,'"');addLabel(S,f,drawGraphicsLayer,"11pt"),x=null,S=null}else map.addLayer(drawGraphicsLayer),drawGraphicsLayer.refresh()}p=null,m=null,y=null})}function addPolys(e,t){require(["esri/graphic","esri/layers/GraphicsLayer","esri/geometry/Polygon","esri/geometry/Point","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","dojo/_base/Color","esri/geometry/Geometry"],function(l,n,a,r,d,s,o,m){var y,p,c=e.split(","),u=/;/g,g=/\\'/g,b=/\\"/g;for(i=0;i<c.length;i++){var w,v;if(y=c[i].split("|"),drawGraphicsLayer=new n,drawGraphicsLayer.id="drawgraphics"+drawGraphicsCounter,drawGraphicsCount.push(drawGraphicsLayer.id),drawGraphicsCounter++,document.getElementById("clearGraphics").style.visibility="visible",y[1].indexOf(";")>-1){var I=y[1].split(";");I[0]=parseInt(I[0]),I[1]=parseInt(I[1]),I[2]=parseInt(I[2]),I[3]=parseFloat(I[3]),w=new o(I),I=null}else w=new o("#"+parseInt(y[1]).toString(16)),w.a=parseFloat(y[2]);if(y[4].indexOf(";")>-1){var h=y[4].split(";");h[0]=parseInt(h[0]),h[1]=parseInt(h[1]),h[2]=parseInt(h[2]),v=new o(h),h=null}else v=new o("#"+parseInt(y[4]).toString(16));var L,E=new d(d.STYLE_SOLID,v,2),x=new s(y[0],E,w),S=[],f=7;for(p=new a(t),j=0;j<y[6];j++){var B=y[f++];for(k=0;k<B;k++)L=[],L.push(parseFloat(y[f++])),L.push(parseFloat(y[f++])),S.push(L),L=null;p.addRing(S),S=null,S=[]}if(drawGraphicsLayer.add(new l(p,x)),y.length>f){var T=new r(parseFloat(y[f++]),parseFloat(y[f++]),t),G=new l(T),C=y[f++].replace(u,",").replace(g,"'").replace(b,'"');addLabel(G,C,drawGraphicsLayer,"11pt"),T=null,G=null}else map.addLayer(drawGraphicsLayer),drawGraphicsLayer.refresh()}c=null,y=null,p=null})}function addRects(e,t){require(["esri/graphic","esri/geometry/Extent","esri/layers/GraphicsLayer","esri/geometry/Polygon","esri/geometry/Point","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","dojo/_base/Color","esri/geometry/Geometry"],function(l,n,a,r,d,s,o,m,y){var p,c,u=e.split(","),g=/;/g,b=/\\'/g,w=/\\"/g;for(i=0;i<u.length;i++){var v;c=u[i].split("|"),drawGraphicsLayer=new a,drawGraphicsLayer.id="drawgraphics"+drawGraphicsCounter,drawGraphicsCount.push(drawGraphicsLayer.id),drawGraphicsCounter++,document.getElementById("clearGraphics").style.visibility="visible";var I,h=!1;if(c[1].indexOf(";")>-1){var L=c[1].split(";");L[0]=parseInt(L[0]),L[1]=parseInt(L[1]),L[2]=parseInt(L[2]),L[3]=parseFloat(L[3]),v=new m(L),L=null}else h=!0,v=new m("#"+parseInt(c[1]).toString(16)),v.a=parseFloat(c[2]);if(c[4].indexOf(";")>-1){var E=c[4].split(";");E[0]=parseInt(E[0]),E[1]=parseInt(E[1]),E[2]=parseInt(E[2]),I=new m(E),E=null}else I=new m("#"+parseInt(c[4]).toString(16));var x,S=new s(s.STYLE_SOLID,I,2),f=new o(c[0],S,v),B=[],T=6;if(h){var G=new n(c[6],c[7],c[8],c[9],map.spatialReference);drawGraphicsLayer.add(new l(G,f)),G=null,T=10}else{for(p=new r(t),j=0;j<5;j++)x=[],x.push(parseFloat(c[T++])),x.push(parseFloat(c[T++])),B.push(x),x=null;p.addRing(B),B=null,drawGraphicsLayer.add(new l(p,f))}if(c.length>T){var C=new d(parseFloat(c[T++]),parseFloat(c[T++]),t),_=new l(C),N=c[T++].replace(g,",").replace(b,"'").replace(w,'"');addLabel(_,N,drawGraphicsLayer,"11pt"),C=null,_=null}else map.addLayer(drawGraphicsLayer),drawGraphicsLayer.refresh()}u=null,c=null,p=null})}function addLabels(e,t){require(["esri/graphic","esri/layers/GraphicsLayer","esri/geometry/Point"],function(l,n,a){var r,d,s,o=/;/g,m=/\\'/g,y=/\\"/g,p=e.split(",");for(i=0;i<p.length;i++){d=p[i].split("|"),drawTextGraphicsLayer=new n,drawTextGraphicsLayer.id="drawtextgraphics"+drawTextGraphicsCounter,drawTextGraphicsCount.push(drawTextGraphicsLayer.id),drawTextGraphicsCounter++,document.getElementById("clearText").style.visibility="visible";var c=d[4];d[2]=d[2].replace(o,",").replace(m,"'").replace(y,'"');var u=decodeURIComponent(d[2]);r=new a(parseFloat(d[0]),parseFloat(d[1]),t),s=new l(r),addLabel(s,u,drawTextGraphicsLayer,c),map.addLayer(drawTextGraphicsLayer)}p=null,d=null,r=null,s=null})}var toolbar,labelPoint,drawText=!1;