function unloadHandler(e){}function addOverviewMap(){require(["esri/dijit/OverviewMap"],function(e){var r=new e({id:"ovMap",map:map,attachTo:"top-left",visible:!1});r.startup(),r.on("click",function(){this.visible&&0==overviewOpen&&"function"==typeof gtag?(gtag("event","widget_click",{widget_name:"Overview"}),overviewOpen=!0):this.visible||(overviewOpen=!1)})})}function lookupAddress(){require(["dojo/dom"],function(e){"function"==typeof ga&&ga("send","event","address","click","Address","1"),"function"==typeof gtag&&gtag("event","widget_click",{widget_name:"Address"});var r=e.byId("streetTxt").value,t=/([^a-zA-Z0-9 \-\',\.()])/g;if(t.test(r))return r=r.replace(t,""),e.byId("streetTxt").value=r,void alert("Illegal characters were removed from the address.","Warning");var a=e.byId("cityTxt").value;if(t=/([^a-zA-Z0-9 \-\'()])/g,t.test(a))return a=a.replace(t,""),e.byId("cityTxt").value=a,void alert("Illegal characters were removed from the city.","Warning");var i=e.byId("zipTxt").value;if(t=/([^0-9 \-])/g,t.test(i))return i=i.replace(t,""),e.byId("zipTxt").value=i,void alert("Illegal characters were removed from the zip code.","Warning");""!==r&&""!==a?require(["esri/geometry/Extent"],function(t){showLoading(),e.byId("addressLoading").style.display="block";var l={Address:r,City:a,Region:"CO",Postal:i};locator.outSpatialReference=map.spatialReference;var s=new t({xmin:-1235e4,ymin:425e4,xmax:-1115e4,ymax:525e4,spatialReference:{wkid:wkid}}),n={address:l,searchExtent:s};locator.addressToLocations(n,onAddressResults,onAddressFault)}):(hideLoading(),e.byId("addressLoading").style.display="none",alert("Street and City are required fields.","Warning"))})}function onAddressResults(e){try{require(["dojo/dom","esri/symbols/SimpleMarkerSymbol","esri/symbols/PictureMarkerSymbol","esri/graphic","esri/symbols/Font","esri/symbols/TextSymbol","dojo/_base/Color"],function(r,t,a,i,l,s,n){hideLoading(),r.byId("addressLoading").style.display="none";var o,d=new a("assets/images/i_address.png",30,30);return e.every(function(e){var r;e.score>40&&require(["esri/layers/GraphicsLayer","dojo/_base/Color"],function(t,a){o=e.location,r=new t,r.id="addressgraphics"+addressGraphicsCounter,addressGraphicsCount.push(r.id),addressGraphicsCounter++,r.add(new i(o,d));var n=e.address,y=new l("10pt",l.STYLE_NORMAL,l.VARIANT_NORMAL,l.WEIGHT_BOLD,"Helvetica"),g=new a([255,255,153,255]),u=new s(n,y,new a("#000000"));u.setOffset(0,-23);var c=new esri.symbol.TextSymbol(n,y,g);c.setOffset(1,-25);var p=new esri.symbol.TextSymbol(n,y,g);p.setOffset(0,-24);var m=new esri.symbol.TextSymbol(n,y,g);m.setOffset(0,-22);var b=new esri.symbol.TextSymbol(n,y,g);b.setOffset(-1,-21);var f=new esri.symbol.TextSymbol(n,y,g);f.setOffset(2,-23);var h=new esri.symbol.TextSymbol(n,y,g);return h.setOffset(-2,-23),r.add(new esri.Graphic(o,c)),r.add(new esri.Graphic(o,p)),r.add(new esri.Graphic(o,m)),r.add(new esri.Graphic(o,b)),r.add(new esri.Graphic(o,f)),r.add(new esri.Graphic(o,h)),r.add(new i(o,u)),map.addLayer(r),!1})}),void 0!==o?(map.centerAndZoom(o,6),!0):(alert("Address was not found.","Note"),!1)})}catch(e){return alert("Error looking up address: "+e.message,"Code Error",e),!1}}function onAddressFault(e){require(["dojo/dom"],function(r){hideLoading(),r.byId("addressLoading").style.display="none",alert("Error occurred searching for address. Address service may be down. Service name is: "+locator.url+". "+e.message,"Code Error",e)})}function clearAddress(){0!=addressGraphicsCount.length&&map.getLayer(addressGraphicsCount.pop()).clear()}function readConfig(){require(["dojo/dom","dojo/io-query","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/FeatureLayer","esri/tasks/GeometryService","esri/SpatialReference","esri/tasks/ProjectParameters","esri/map","esri/geometry/Extent","esri/dijit/Popup","esri/symbols/SimpleFillSymbol","esri/tasks/locator","dijit/form/CheckBox","agsjs/dijit/TOC","esri/symbols/SimpleLineSymbol","esri/layers/ArcGISTiledMapServiceLayer","esri/dijit/BasemapGallery","esri/dijit/Basemap","esri/dijit/BasemapLayer","esri/arcgis/utils","esri/dijit/Gallery","dojo/sniff"],function(e,r,t,a,l,s,n,o,d,y,g,u,c,p,m,b,f,h,v,w,E,O){function I(){try{var e;e=queryObj.prj&&""!=queryObj.prj?new s(parseInt(queryObj.prj)):new s(102100),queryObj.point&&""!=queryObj.point&&addPoints(queryObj.point,e),queryObj.line&&""!=queryObj.line&&addLines(queryObj.line,e),queryObj.poly&&""!=queryObj.poly&&addPolys(queryObj.poly,e),queryObj.rect&&""!=queryObj.rect&&addRects(queryObj.rect,e),queryObj.text&&""!=queryObj.text&&addLabels(queryObj.text,e),e=null}catch(e){alert("Error loading graphics from the URL. In javascript/readConfig.js. Error message: "+e.message,"URL Graphics Error",e)}}function x(){function e(e){var i,s=e.getAttribute("label");if(C[s]++,queryObj.layer&&""!=queryObj.layer)if(e.getAttribute("url").toLowerCase().indexOf("mapserver")>-1)i=layerObj[s]?new t(e.getAttribute("url"),{opacity:layerObj[s].opacity,id:s,visible:layerObj[s].visible,visibleLayers:layerObj[s].visLayers}):new t(e.getAttribute("url"),{opacity:Number(e.getAttribute("alpha")),id:s,visible:!1});else{if(!(e.getAttribute("url").toLowerCase().indexOf("featureserver")>-1))return void alert("Unknown operational layer type. It must be of type MapServer or FeatureServer. Or edit readConfig.js line 600 to add new type.");i=layerObj[s]?new a(e.getAttribute("url"),{opacity:Number(e.getAttribute("alpha")),id:s,visible:layerObj[s].visible,visibleLayers:layerObj[s].visLayers}):new a(e.getAttribute("url"),{opacity:Number(e.getAttribute("alpha")),id:s,visible:!1})}else if(e.getAttribute("url").toLowerCase().indexOf("mapserver")>-1)i="false"==e.getAttribute("visible")?new t(e.getAttribute("url"),{opacity:Number(e.getAttribute("alpha")),id:s,visible:!1}):new t(e.getAttribute("url"),{opacity:Number(e.getAttribute("alpha")),id:s,visible:!0});else{if(!(e.getAttribute("url").toLowerCase().indexOf("featureserver")>-1))return alert("Unknown operational layer type. It must be of type MapServer or FeatureServer. Or edit readConfig.js line 600 to add new type."),void hideLoading();i="false"==e.getAttribute("visible")?new a(e.getAttribute("url"),{opacity:Number(e.getAttribute("alpha")),id:s,visible:!1}):new a(e.getAttribute("url"),{opacity:Number(e.getAttribute("alpha")),id:s,visible:!0})}i.on("load",r),i.on("error",l)}function r(e){try{for(var r,t,a=[],i=0;i<S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer").length;i++)e.layer.id===S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[i].getAttribute("label")&&(t=S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[i]);if(B){r=!1,"false"==t.getAttribute("open")&&(r=!0);var l=t.getAttribute("opensublayer");l&&(a=l.split(",")),l=null}else{r=!0,e.layer.visible&&(r=!1);var s,n=new Array(0,1,2,3,4,5,6,7,8,9),o=[];if(layerObj[e.layer.id]){if(o=e.layer.layerInfos,"Hunter Reference"==e.layer.id){for(s=0;s<layerObj[e.layer.id].visLayers.length;s++)if(o[layerObj[e.layer.id].visLayers[s]].name.substr(o[layerObj[e.layer.id].visLayers[s]].name.length-3,3).indexOf("GMU")>-1){gmu=o[layerObj[e.layer.id].visLayers[s]].name;break}}else if("Game Species"==e.layer.id)for(s=0;s<layerObj[e.layer.id].visLayers.length;s++){if("Bighorn Sheep"===o[layerObj[e.layer.id].visLayers[s]].name){gmu="Bighorn GMU";break}if("Mountain Goat"===o[layerObj[e.layer.id].visLayers[s]].name){gmu="Goat GMU";break}}for(s=0;s<o.length;s++)-1!=layerObj[e.layer.id].visLayers.indexOf(o[s].id)?o[s].defaultVisibility=!0:-1==o[s].parentLayerId||o[s].subLayerIds?o[s].defaultVisibility=!1:o[s].name.substr(o[s].name.length-3,3).indexOf("GMU")>-1||1==o[s].defaultVisibility&&-1===layerObj[e.layer.id].visLayers.indexOf(o[s].parentLayerId)&&(layerObj[e.layer.id].visLayers.push(s),n.indexOf(parseInt(o[o[s].parentLayerId].name.substr(0,1)))>-1&&(layerObj[e.layer.id].visLayers.push(o[s].parentLayerId),o[o[s].parentLayerId].defaultVisibility=!0));e.layer.setVisibleLayers(layerObj[e.layer.id].visLayers.sort(function(e,r){return e-r})),e.layer.refresh()}}legendLayers.push({layer:e.layer,title:e.layer.id,autoToggle:!0,slider:!0,slider_ticks:3,slider_labels:["transparent","50%","opaque"],hideGroupSublayers:hideGroupSublayers,radioLayers:radioLayers,noLegend:!0,openSubLayers:a,collapsed:r}),map.addLayer(e.layer),G++,G==A&&hideLoading(),a=null}catch(e){alert("Error in readConfig.js/layerLoadedHandler "+e.message,"Code Error",e),hideLoading()}}function l(r){for(var t,a=0;a<S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer").length;a++)if(S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[a].getAttribute("label")===r.target.id){t=S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[a];break}C[r.target.id]<5?setTimeout(function(){e(t)},2e3):5==C[r.target.id]?(r.target.id.indexOf("Motor Vehicle")>-1||r.target.id.indexOf("Wildfire")>-1||r.target.id.indexOf("BLM")>-1?alert("The external map service that provides "+r.target.id+" is experiencing problems.  This issue is out of CPW control. We will continue to try to load it. We apologize for any inconvenience.","External (Non-CPW) Map Service Error"):alert(r.target.id+" service is busy or not responding. We will continue to try to load it.","Data Error"),setTimeout(function(){e(t)},3e4),hideLoading()):setTimeout(function(){e(t)},3e4)}if(B=!0,queryObj.layer&&""!=queryObj.layer){B=!1;var s=queryObj.layer.substring(queryObj.layer.indexOf("|")+1).split(",");for(layerObj={},i=0;i<s.length;i++){var n=s[i].split("|");if(""!=n[0])for(n[0]=n[0].replace(/~/g," "),3==n.length&&n.push(!0),-1==n[2]?layerObj[n[0]]={opacity:n[1],visLayers:[],visible:!0}:layerObj[n[0]]={opacity:n[1],visLayers:n[2].split("-"),visible:"1"==n[3]},j=0;j<layerObj[n[0]].visLayers.length;j++)layerObj[n[0]].visLayers[j]=0|layerObj[n[0]].visLayers[j]}}try{S.getElementsByTagName("hideGroupSublayers")[0]&&S.getElementsByTagName("hideGroupSublayers")[0].firstChild&&(hideGroupSublayers=S.getElementsByTagName("hideGroupSublayers")[0].firstChild.nodeValue.split(","))}catch(e){alert("Warning: Missing hideGroupSublayers tag in "+app+"/config.xml file. "+e.message,"Data Error")}try{S.getElementsByTagName("radiolayers")[0]&&S.getElementsByTagName("radiolayers")[0].firstChild&&(radioLayers=S.getElementsByTagName("radiolayers")[0].firstChild.nodeValue.split(","))}catch(e){alert("Warning: Missing radiolayers tag in "+app+"/config.xml file. "+e.message,"Data Error")}var o=S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer");for(A=o.length,i=0;i<o.length;i++)C[o[i].getAttribute("label")]=0,e(o[i])}function L(){require(["dojo/dom","dijit/registry"],function(e,r){for(var t="",a=0;a<S.getElementsByTagName("widget").length;a++){var i="open"==S.getElementsByTagName("widget")[a].getAttribute("preload"),l=S.getElementsByTagName("widget")[a].getAttribute("label"),s=S.getElementsByTagName("widget")[a].getAttribute("height"),n=S.getElementsByTagName("widget")[a].getAttribute("video"),o=S.getElementsByTagName("widget")[a].getAttribute("icon");if(null!=l)if(t+=l,"Map Layers & Legend"==l)null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Map Layers & Legend.","Data Error"),e.byId("tocHelp").href=n,o&&(document.getElementById("tocIcon").src=o),i&&r.byId("tocPane").toggle(),e.byId("tocPane").style.display="block",e.byId("tocPane").style.visibility="visible",s&&""!=s&&(document.getElementById("tocContent").style.height=s+"px");else if("HB1298 Report"==l)null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Map Layers & Legend.","Data Error"),e.byId("hb1298Help").href=n,o&&(document.getElementById("hb1298Icon").src=o),document.getElementById("hb1298Pane").style.display="block",i&&(openedHB1298=!0,loadjscssfile("javascript/hb1298.js","js"));else if(l.indexOf("Report")>0)null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget "+l+".","Data Error"),e.byId("reportHelp").href=n,o&&(document.getElementById("reportIcon").src=o),e.byId("reportTitle").innerHTML=l,i&&r.byId("reportDiv").toggle(),e.byId("reportDiv").style.display="block",e.byId("reportDiv").style.visibility="visible",reportInit();else if("Feature Search"==l)null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Feature Search.","Data Error"),e.byId("searchHelp").href=n,o&&(document.getElementById("searchIcon").src=o),i&&(r.byId("searchDiv").toggle(),openedFeatureSearch=!0,searchInit()),e.byId("searchDiv").style.display="block",e.byId("searchDiv").style.visibility="visible";else if("Address"==l){try{locator=new u(S.getElementsByTagName("addressservice")[0].getAttribute("url"))}catch(e){alert("Missing tag: addressservice in "+app+'/config.xml.\n\nTag should look like: &lt;addressservice url="https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/findAddressCandidates"/&gt;\n\nWill use that url for now.',"Data Error"),locator=new u("https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/findAddressCandidates")}null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Address.","Data Error"),o&&(document.getElementById("addressIcon").src=o),e.byId("addressHelp").href=n,i&&r.byId("addressPane").toggle(),e.byId("addressPane").style.display="block",e.byId("addressPane").style.visibility="visible"}else"Draw, Label, & Measure"==l?(null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Draw, Label, & Measure.","Data Error"),e.byId("drawHelp").href=n,o&&(document.getElementById("drawIcon").src=o),i&&r.byId("drawDiv").toggle(),e.byId("drawDiv").style.display="block",e.byId("drawDiv").style.visibility="visible"):"Bookmark"==l?(null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Bookmark.","Data Error"),e.byId("bookmarkHelp").href=n,o&&(document.getElementById("bookmarkIcon").src=o),setBookmarks(),i&&r.byId("bookmarkDiv").toggle(),e.byId("bookmarkDiv").style.display="block",e.byId("bookmarkDiv").style.visibility="visible"):"Settings"==l?(null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Settings.","Data Error"),e.byId("settingsHelp").href=n,o&&(document.getElementById("settingsIcon").src=o),i&&r.byId("settingsDiv").toggle(),e.byId("settingsDiv").style.display="block",e.byId("settingsDiv").style.visibility="visible"):"Find a Place"==l||("Print"==l?o&&(document.getElementById("printIcon").src=o):"Identify"==l||("GetExtent"==l?o&&(document.getElementById("extentIcon").src=o):"MapLink"==l?o&&(document.getElementById("linkIcon").src=o):alert("Error in "+app+"/config.xml widget. Label: "+l+" was not found.  \n\nAvailable options include:\n\tMap Layers & Legend\n\t<something> Resource Report \n\tFeature Search\n\tAddress\n\tDraw, Label, & Measure\n\tBookmark\n\tFind a Place\n\tPrint\n\tSettings\n\tIdentify\n Edit javascript/readConfig.js to change this.","Data Error")))}printInit(),-1==t.indexOf("Map Layers & Legend")?e.byId("tocPane").style.display="none":e.byId("reportDiv")&&-1==t.indexOf("Report")?e.byId("reportDiv").style.display="none":-1==t.indexOf("Feature Search")?e.byId("searchDiv").style.display="none":-1==t.indexOf("Address")?e.byId("addressPane").style.display="none":-1==t.indexOf("Draw, Label, & Measure")?e.byId("drawDiv").style.display="none":-1==t.indexOf("Bookmark")?e.byId("bookmarkDiv").style.display="none":-1==t.indexOf("Settings")&&(e.byId("settingsDiv").style.display="none");for(var d='<span class="link"><a href="'+app+'/help.html" target="help"><img src="assets/images/i_help.png"/>Help</a></span>',y=S.getElementsByTagName("links")[0].getElementsByTagName("link"),g="",c=0;c<y.length;c++)"Go Mobile"==y[c].getAttribute("label")?d+='<span class="link"><a href="'+window.location.href.replace("index","indexM")+'" target="_top"><img src="'+y[c].getAttribute("icon")+'"/>'+y[c].getAttribute("label")+"</a></span>":"Buy License!"==y[c].getAttribute("label")?(g=y[c].getAttribute("url").replace("%3F","?").replace("%26","&"),d+='<span class="link"><a id="licenseLink"><img src="'+y[c].getAttribute("icon")+'"/>'+y[c].getAttribute("label")+"</a></span>"):d+='<span class="link"><a href="'+y[c].getAttribute("url").replace("%3F","?").replace("%26","&")+'" target="_new"><img src="'+y[c].getAttribute("icon")+'"/>'+y[c].getAttribute("label")+"</a></span>";e.byId("links").innerHTML=d,document.getElementById("licenseLink")&&document.getElementById("licenseLink").addEventListener("click",function(){"function"==typeof ga&&ga("send","event","buy_license","click","Buy License","1"),"function"==typeof gtag&&gtag("event","widget_click",{widget_name:"Buy License"}),window.open(g,"_new")}),x()})}function q(){require(["esri/layers/OpenStreetMapLayer","dojo/dom","dijit/registry","dojo/sniff","dojo/on"],function(e,r,t,a,i){try{if(mapBasemap="streets",queryObj.layer&&""!=queryObj.layer){var l=queryObj.layer.substring(0,queryObj.layer.indexOf("|")).split(",");0==l[0]?mapBasemap="streets":1==l[0]?mapBasemap="hybrid":2==l[0]?mapBasemap="topo":mapBasemap=l[0],l=null}map.infoWindow.resize(330,350),customLods=[{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.992452562495,scale:4622324.434309},{level:8,resolution:611.4962262813797,scale:2311162.217155},{level:9,resolution:305.74811314055756,scale:1155581.108577},{level:10,resolution:152.87405657041106,scale:577790.554289},{level:11,resolution:76.43702828507324,scale:288895.277144},{level:12,resolution:38.21851414253662,scale:144447.638572},{level:13,resolution:19.10925707126831,scale:72223.819286},{level:14,resolution:9.554628535634155,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822}],previewMap=new o("printPreviewMap",{extent:initExtent,autoResize:!0,showAttribution:!1,logo:!1,basemap:"streets",isRubberBandZoom:!0,isScrollWheelZoom:!0,isShiftDoubleClick:!0,displayGraphicsOnPan:!a("ie"),sliderStyle:"large",minScale:9244649,lods:customLods}),customLods=null;var s,n,d=[];s=new v({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}),n=new h({layers:[s],title:"Streets",id:"streets",thumbnailUrl:"https://www.arcgis.com/sharing/rest/content/items/f81bc478e12c4f1691d0d7ab6361f5a6/info/thumbnail/street_thumb_b2wm.jpg"}),d.push(n),layers=[];var y=new v({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"});layers.push(y),y=new v({styleUrl:"https://www.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",type:"VectorTileLayer",opacity:1}),layers.push(y),n=new h({layers:layers,title:"Aerial Photo",id:"hybrid",thumbnailUrl:"https://www.arcgis.com/sharing/rest/content/items/2ea9c9cf54cb494187b03a5057d1a830/info/thumbnail/Jhbrid_thumb_b2.jpg"}),d.push(n),s=new v({url:"https://services.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer"}),n=new h({layers:[s],title:"USGS Scanned Topo",id:"topo",thumbnailUrl:"assets/images/USA_topo.png"}),d.push(n),s=new v({url:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSTopo/MapServer"}),n=new h({layers:[s],title:"USGS Digital Topo",id:"natgeo",thumbnailUrl:"https://usfs.maps.arcgis.com/sharing/rest/content/items/6d9fa6d159ae4a1f80b9e296ed300767/info/thumbnail/thumbnail.jpeg"}),d.push(n),layers=[],s=new v({url:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer",displayLevels:[6,7,8,9,10,11,12,13,14,15,16]}),layers.push(s),s=new v({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",displayLevels:[17,18,19]}),layers.push(s),n=new h({layers:layers,title:"Aerial Photo with USGS Contours",id:"imagery_topo",thumbnailUrl:"assets/images/aerial_topo.png"}),d.push(n),s=new v({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer"}),n=new h({layers:[s],title:"ESRI Digital Topo",id:"topo2",thumbnailUrl:"https://www.arcgis.com/sharing/rest/content/items/588f0e0acc514c11bc7c898fed9fc651/info/thumbnail/topo_thumb_b2wm.jpg"}),d.push(n),basemapGallery=new f({map:map,basemaps:d,showArcGISBasemaps:!1});var g=!0;if(i(t.byId("basemapTitlePane"),"toggle",function(){g?(g=!1,document.getElementById("basemapDiv").style.overflow="auto",document.getElementById("basemapDiv").style.height="90%"):(g=!0,document.getElementById("basemapDiv").style.overflow="hidden",document.getElementById("basemapDiv").style.height="30px")}),!basemapGallery.showArcGISBasemaps){var u=[];basemapGallery.basemaps.forEach(function(e){u.push({thumbnailUrl:e.thumbnailUrl,id:e.id,layers:e.layers,title:e.title})});var c,p={},m=null;for(c=0;c<u.length;c++)if("Streets"==u[c].title){m=u[c],u.moveTo(m,0);break}var b,j=null;for(c=0;c<u.length;c++)if("USA Topo Maps"==u[c].title){j=u[c],u.moveTo(j,2);break}for(c=0;c<u.length;c++)u[c].id==mapBasemap&&(b=c);p.items=u,p.thumbnailStyle="small";var w=new E(p,"basemapGallery");w.on("select",function(e){for(var a=r.byId("basemapGallery").firstChild.children,i=0;i<a.length;i++)a[i].children[1].childNodes[0].nodeValue==e.item.title?(a[i].attributes.class.value="thumbnailcontainer small selected",a[i].children[0].attributes.class.value="thumbnail small selected",a[i].children[1].attributes.class.value="title small selected",a[i].children[2].attributes.class.value="title small selected"):(a[i].attributes.class.value="thumbnailcontainer small",a[i].children[0].attributes.class.value="thumbnail small",a[i].children[1].attributes.class.value="title small",a[i].children[2].attributes.class.value="title small");basemapGallery.select(e.item.id),mapBasemap=e.item.id,t.byId("basemapTitlePane").toggle(),"function"!=typeof ga&&"function"!=typeof gtag||(initBasemap&&("function"==typeof ga&&ga("send","event","basemap","click","Basemap","1"),"function"==typeof gtag&&(gtag("event","widget_click",{widget_name:"Basemap"}),gtag("event","basemap_change",{basemap:e.item.id}))),initBasemap=!0)}),w.select(p.items[b]),t.byId("basemapTitlePane").toggle(),w._slideDiv.style.width="auto",w.startup(),r.byId("basemapTitlePane").style.visibility="visible",r.byId("basemapTitlePane").style.display="block",w.on("error",function(e){alert("Basemap gallery error creating gallery in readConfig.js/addMap/basemapGallery.on('load'):  "+JSON.stringify(e,null,4),"Code Error")})}basemapGallery.on("load",function(){var e=[];basemapGallery.basemaps.forEach(function(r){var t=["Imagery Hybrid","Streets","USA Topo Maps","National Geographic Style Map","USGS Scanned Topo","My USGS Digital Topo","Aerial Photo with USGS Contours","ESRI Digital Topo"];if(t.includes(r.title)){if("Imagery Hybrid"==r.title)r.id="hybrid",r.title="Aerial";else{if("Imagery"==r.title||"Oceans"==r.title)return;"Streets"==r.title?r.id="streets":"USA Topo Maps"==r.title?r.id="topo":"ESRI Digital Topo"==r.title?r.id="topo2":"OpenStreetMap"==r.title?r.id="openstreet":"National Geographic Style Map"==r.title&&(r.id="natgeo")}e.push({thumbnailUrl:r.thumbnailUrl,id:r.id,layers:r.layers,title:r.title})}});var a,i={},l=null;for(a=0;a<e.length;a++)if("Streets"==e[a].title){l=e[a],e.moveTo(l,0);break}var s,n=null;for(a=0;a<e.length;a++)if("USA Topo Maps"==e[a].title){n=e[a],e.moveTo(n,2);break}for(a=0;a<e.length;a++)e[a].id==mapBasemap&&(s=a);document.getElementById("basemapGallery").style.height="350px",document.getElementById("basemapGallery").style.overflow="auto",i.items=e,i.thumbnailStyle="small";var o=new E(i,"basemapGallery");o.on("select",function(e){for(var a=r.byId("basemapGallery").firstChild.children,i=0;i<a.length;i++)a[i].children[1].childNodes[0].nodeValue==e.item.title?(a[i].attributes.class.value="thumbnailcontainer small selected",a[i].children[0].attributes.class.value="thumbnail small selected",a[i].children[1].attributes.class.value="title small selected",a[i].children[2].attributes.class.value="title small selected"):(a[i].attributes.class.value="thumbnailcontainer small",a[i].children[0].attributes.class.value="thumbnail small",a[i].children[1].attributes.class.value="title small",a[i].children[2].attributes.class.value="title small");basemapGallery.select(e.item.id),mapBasemap=e.item.id,t.byId("basemapTitlePane").toggle()}),o.select(i.items[s]),t.byId("basemapTitlePane").toggle(),o._slideDiv.style.width="auto",o.startup(),r.byId("basemapTitlePane").style.visibility="visible",r.byId("basemapTitlePane").style.display="block",o.on("error",function(e){alert("Basemap gallery error creating gallery in readConfig.js/addMap/basemapGallery.on('load'):  "+JSON.stringify(e,null,4),"Code Error")})}),basemapGallery.on("error",function(e){alert("Basemap gallery error creating basemapGallery in readConfig.js/addMap/basemapGallery.on('load'):  "+JSON.stringify(e,null,4),"Code Error")}),L()}catch(e){alert("Error in readConfig.js/addMap "+e.message,"Code Error",e)}})}function T(){if(queryObj.extent&&""!=queryObj.extent){var e,r=[];r="[object Array]"===Object.prototype.toString.call(queryObj.extent)?queryObj.extent[0].split(","):queryObj.extent.split(","),e=queryObj.prj&&""!=queryObj.prj?queryObj.prj:r[0]<0&&r[0]>-200?4326:26913,k=new d({xmin:parseFloat(r[0]),ymin:parseFloat(r[1]),xmax:parseFloat(r[2]),ymax:parseFloat(r[3]),spatialReference:{wkid:parseInt(e)}});var t=new n;t.geometries=[k],t.outSR=new s(wkid),geometryService.project(t,function(e){initExtent=e[0],map.setExtent(initExtent)},function(t){alert("There was a problem converting the extent read from the URL to Web Mercator projection. extent="+r[0],", "+r[1]+", "+r[2]+", "+r[3]+"  prj="+e+"  "+t.message,"URL Extent Error",t)})}if(queryObj.place&&""!=queryObj.place){var a=queryObj.place.replace("%20"," ");queryObj.prj&&""!=queryObj.prj&&(settings={XYProjection:queryObj.prj}),gotoLocation(a,!0)}else queryObj.keyword&&""!=queryObj.keyword?queryObj.value&&""!=queryObj.value?require(["esri/request","esri/tasks/QueryTask","esri/tasks/query"],function(e,r,t){var a=app+"/url.xml?v="+ndisVer,i=createXMLhttpRequest();i.onreadystatechange=function(){if(4==i.readyState&&200===i.status){for(var e=createXMLdoc(i),a=e.getElementsByTagName("layer"),l=0;l<a.length&&(a[l].getElementsByTagName("keyword")[0]&&a[l].getElementsByTagName("keyword")[0].firstChild||alert("Missing tag keyword or blank, in "+app+"/url.xml file.","Data Error"),queryObj.keyword!=a[l].getElementsByTagName("keyword")[0].firstChild.nodeValue);l++);if(l==a.length)map.setExtent(initExtent),alert("Keyword ["+queryObj.keyword+"] is not defined in "+app+"/url.xml file.","Data Error");else if(a[l].getElementsByTagName("url")[0]&&a[l].getElementsByTagName("url")[0].firstChild||(map.setExtent(initExtent),alert("Missing tag url or blank, in "+app+"/url.xml file for keyword: "+queryObj.keyword+".","Data Error")),a[l].getElementsByTagName("expression")[0]&&a[l].getElementsByTagName("expression")[0].firstChild){var s=a[l].getElementsByTagName("expression")[0].firstChild.nodeValue.replace("[value]",queryObj.value),n=new r(a[l].getElementsByTagName("url")[0].firstChild.nodeValue),o=new t;o.where=s,o.returnGeometry=!0,n.execute(o,function(e){0==e.features.length?gotoLocation(queryObj.value,!0):require(["esri/geometry/Point","esri/graphicsUtils","esri/layers/GraphicsLayer","esri/graphic","esri/symbols/PictureMarkerSymbol"],function(r,t,i,s,n){var o,y;if("esriGeometryPoint"==e.geometryType){var g=8;if(a[l].getElementsByTagName("mapscale")[0]&&a[l].getElementsByTagName("mapscale")[0].firstChild&&(g=parseInt(a[l].getElementsByTagName("mapscale")[0].firstChild.nodeValue)),g>11&&(g=8),o=new r(e.features[0].geometry.x,e.features[0].geometry.y,e.spatialReference),map.centerAndZoom(o,g),queryObj.label&&""!=queryObj.label){y=new i,y.id="searchgraphics"+searchGraphicsCounter,searchGraphicsCount.push(y.id),searchGraphicsCounter++,addLabel(new s(o),queryObj.label,y,"11pt");var u=new n("assets/images/yellowdot.png",30,30);y.add(new s(o,u)),document.getElementById("findClear").style.opacity=1,document.getElementById("findClear").style.filter="alpha(opacity=100)"}}else if("esriGeometryPolygon"==e.geometryType){var c=!1;if(a[l].getElementsByTagName("union")[0]&&a[l].getElementsByTagName("union")[0].firstChild&&"true"===a[l].getElementsByTagName("union")[0].firstChild.nodeValue.toLowerCase()&&(c=!0),c){for(var p=new d(e.features[0].geometry.getExtent()),m=0;m<e.features.length;m++){var b=e.features[m].geometry.getExtent();p=p.union(b)}map.setExtent(p),o=p.getCenter()}else o=e.features[0].geometry.getCentroid(),map.setExtent(e.features[0].geometry.getExtent(),!0);queryObj.label&&""!=queryObj.label&&(y=new i,y.id="searchgraphics"+searchGraphicsCounter,searchGraphicsCount.push(y.id),searchGraphicsCounter++,addLabel(new s(o),queryObj.label,y,"11pt"),document.getElementById("findClear").style.opacity=1,document.getElementById("findClear").style.filter="alpha(opacity=100)")}else map.setExtent(e.features[0].geometry.getExtent(),!0)})},function(e){e.responseText?(map.setExtent(initExtent),alert("Error: QueryTask failed for keyword="+queryObj.keyword+" value="+queryObj.value+" "+e.message+e.responseText,"URL Keyword/Value Error",e),document.execCommand("Stop")):(map.setExtent(initExtent),alert("Error: QueryTask failed for keyword="+queryObj.keyword+" value="+queryObj.value+" "+e.message,"URL Keyword/Value Error",e),document.execCommand("Stop"))})}else map.setExtent(initExtent),alert("Missing tag expression, in "+app+"/url.xml file for keyword: "+queryObj.keyword,"Data Error")}else 404===i.status?(map.setExtent(initExtent),alert("Missing url.xml file in "+app+" directory.","Data Error")):4===i.readyState&&500===i.status&&(map.setExtent(initExtent),alert("Error: had trouble reading "+app+"/url.xml file in readConfig.js.","Data Error"))},i.open("GET",a,!0),i.send(null)}):alert("When &keyword is used on the URL, there must be a &value also.","URL Keyword/Value Error"):queryObj.map&&""!=queryObj.map?queryObj.value&&""!=queryObj.value&&queryObj.field&&""!=queryObj.field?require(["esri/request","esri/tasks/QueryTask","esri/tasks/query"],function(e,r,t){var a=new r(queryObj.map),i=new t;Number(queryObj.value)?i.where=queryObj.field+"="+queryObj.value:i.where="UPPER("+queryObj.field+") LIKE UPPER('"+queryObj.value+"')",i.returnGeometry=!0,a.execute(i,function(e){require(["esri/geometry/Point","esri/graphicsUtils"],function(r,t){0==e.features.length?alert("Cannot zoom to "+queryObj.value+". The feature was not found in "+queryObj.map+" for field "+queryObj.field,"URL Map/Value Error"):"esriGeometryPoint"==e.geometryType?map.centerAndZoom(new r(e.features[0].geometry.x,e.features[0].geometry.y,e.spatialReference),8):map.setExtent(e.features[0].geometry.getExtent(),!0)})},function(e){e.responseText?(map.setExtent(initExtent),alert("Error: QueryTask failed for map="+queryObj.map+" "+e.message+e.responseText,"URL Map/Value Error",e)):(map.setExtent(initExtent),alert("Error: QueryTask failed for map="+queryObj.map+" "+e.message,"URL Map/Value Error",e))})}):(map.setExtent(initExtent),alert("When &map is used on the URL, there must also be an &field and &value.","URL Map/Value Error")):map.setExtent(initExtent)}var S,k,B,A,C={},G=0;try{var M,N=getCookie("xycoords");if(document.getElementById("xycoords_combo").value=""==N?"dms":N,queryObj.point&&(queryObj.point=queryObj.point.replace(/~/g," "),M=/([^a-zA-Z0-9 °\-\'\"\|;,\.!_\*()\\])/g,M.test(queryObj.point)&&alert("Illegal characters were removed from way point labels.","Warning"),M=/([^a-zA-Z0-9 °\-\'\"\|;,\.!_\*()])/g,queryObj.point=queryObj.point.replace(M,""),queryObj.point=queryObj.point.replace(/newline/g,"\n")),queryObj.line&&(M=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,M.test(queryObj.line)&&alert("Illegal characters were removed from the line labels.","Warning"),M=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.line=queryObj.line.replace(M,"")),queryObj.poly&&(M=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,M.test(queryObj.poly)&&alert("Illegal characters were removed from the shape (polygon) labels.","Warning"),M=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.poly=queryObj.poly.replace(M,"")),queryObj.rect&&(M=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,
M.test(queryObj.rect)&&alert("Illegal characters were removed from the rectangle labels.","Warning"),M=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.rect=queryObj.rect.replace(M,"")),queryObj.text&&(M=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,M.test(queryObj.text)&&alert("Illegal characters were removed from the point labels.","Warning"),M=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.text=queryObj.text.replace(M,"")),queryObj.layer&&(queryObj.layer=queryObj.layer.replace(/~/g," "),M=/([^a-zA-Z0-9 \-\|,\._()])/g,M.test(queryObj.layer)&&alert("Illegal characters were found on the URL. Layers may not load properly.","Warning"),queryObj.layer=queryObj.layer.replace(M,"")),queryObj.keyword&&(M=/([^a-zA-Z0-9 \-\._()])/g,M.test(queryObj.keyword)&&alert("Illegal characters were found on the URL. Location may not load properly.","Warning"),queryObj.keyword=queryObj.keyword.replace(M,"")),queryObj.value){M=/([^a-zA-Z0-9 \-\',\.!_\*()\\#/&])/g,M.test(queryObj.value)&&alert("Illegal characters were found on the URL. Location may not load properly.","Warning"),M=/([^a-zA-Z0-9 \-\',\.!_\*()#/&])/g,queryObj.value=queryObj.value.replace(M,"");var D=/'/g;queryObj.value=queryObj.value.replace(D,"''")}queryObj.label&&(M=/([^a-zA-Z0-9 \-\',\.!_\*()#&/\\])/g,M.test(queryObj.label)&&alert("Illegal characters were found on the URL. Point labels may not load properly.","Warning"),M=/([^a-zA-Z0-9 \-\',\.!_\*()#&/])/g,queryObj.label=queryObj.label.replace(M,"")),queryObj.map&&(M=/([^a-zA-Z0-9 \-,\._():\/])/g,M.test(queryObj.map)&&alert("Illegal characters were found on the URL. Map may not load properly.","Warning"),queryObj.map=queryObj.map.replace(M,"")),queryObj.field&&(M=/([^a-zA-Z0-9 \-_])/g,M.test(queryObj.field)&&alert("Illegal characters were found on the URL. Map may not load properly.","Warning"),queryObj.field=queryObj.field.replace(M,"")),queryObj.prj&&isNaN(queryObj.prj)&&(queryObj.prj=102100,alert("Problem reading map projection from the URL, defaulting to WGS84.","Warning")),queryObj.extent&&(M=/([^0-9 \-,\.])/g,M.test(queryObj.extent)&&alert("Illegal characters were found on the URL. Map extent may not load properly.","Warning"),queryObj.extent=queryObj.extent.replace(M,"")),queryObj.place&&(M=/([^a-zA-Z0-9 \-\',\.!_*():#&/\\])/g,M.test(queryObj.place)&&alert("Illegal characters were found on the URL. Location may not load properly.","Warning"),M=/([^a-zA-Z0-9 \-\',\.!_*():#&/])/g,queryObj.place=queryObj.place.replace(M,"")),document.getElementById("mapDescFile").href=app+"/definitions.html";var _=createXMLhttpRequest(),U=app+"/config.xml?v="+ndisVer,P=!1;_.onreadystatechange=function(){if(4==_.readyState&&200===_.status){var r,t;S=createXMLdoc(_);try{r=S.getElementsByTagName("geometryservice")[0].getAttribute("url")}catch(e){alert("Missing tag: geometryservice in "+app+'/config.xml.\n\nTag should look like: &lt;geometryservice url="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/Utilities/Geometry/GeometryServer"/&gt;\n\nWill use that url for now.',"Data Error"),r="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/Utilities/Geometry/GeometryServer"}geometryService=new l(r);try{printServiceUrl=S.getElementsByTagName("printservice")[0].firstChild.nodeValue}catch(e){alert("Missing tag: printservice in "+app+"/config.xml.\n\nTag should look like: &lt;printservice&gt;https://ndismaps.nrel.colostate.edu/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task&lt;/printservice&gt;\n\nWill use that url for now.","Data Error"),printServiceUrl="https://ndismaps.nrel.colostate.edu/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task"}try{printGeoServiceUrl=S.getElementsByTagName("printservicegeo")[0].firstChild.nodeValue}catch(e){alert("Missing tag: printservicegeo in "+app+"/config.xml.\n\nTag should look like: &lt;printservicegeo&gt;https://ndismaps.nrel.colostate.edu/arcgis/rest/services/PrintTemplate/georefPrinting/GPServer/georefPrinting&lt;/printservice&gt;\n\nWill use that url for now.","Data Error"),printGeoServiceUrl="https://ndismaps.nrel.colostate.edu/arcgis/rest/services/PrintTemplate/georefPrinting/GPServer/georefPrinting"}try{t=S.getElementsByTagName("title")[0].firstChild.nodeValue}catch(e){alert("Warning: Missing title tag in "+app+"/config.xml file. "+e.message,"Data Error")}try{e.byId("title").innerHTML=t,document.title=t,e.byId("subtitle").innerHTML=S.getElementsByTagName("subtitle")[0].firstChild.nodeValue,e.byId("logo").src=S.getElementsByTagName("logo")[0].firstChild.nodeValue,e.byId("logourl").href=S.getElementsByTagName("logourl")[0].firstChild.nodeValue}catch(e){alert("Warning: Missing title, subtitle, logo, or logurl tag in "+app+"/config.xml file. "+e.message,"Data Error")}S.getElementsByTagName("noDisclaimer")&&S.getElementsByTagName("noDisclaimer")[0]&&"true"==S.getElementsByTagName("noDisclaimer")[0].firstChild.nodeValue||1!=getCookie("noDisclaimer")&&loadDisclaimer(t);try{myFindService=S.getElementsByTagName("findplaceservice")[0].getAttribute("url")}catch(e){alert("Missing tag: findplaceservice in "+app+'/config.xml.\n\nTag should look like: &lt;findplaceservice url="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/GNIS_Loc/GeocodeServer"/&gt;\n\nWill use that url for now.',"Data Error"),myFindService="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/GNIS_Loc/GeocodeServer"}try{findPlaceInit()}catch(e){alert("Error in javascript/FindPlace.js "+e.message,"Code Error",e)}try{k=S.getElementsByTagName("map")[0].getAttribute("initialextent").split(" "),wkid=parseInt(S.getElementsByTagName("map")[0].getAttribute("wkid").trim()),fullExtent=new d({xmin:parseFloat(k[0]),ymin:parseFloat(k[1]),xmax:parseFloat(k[2]),ymax:parseFloat(k[3]),spatialReference:{wkid:wkid}}),initExtent=fullExtent}catch(e){alert("Warning: Missing tag attributes initalextent or wkid for the map tag in "+app+"/config.xml file. "+e.message,"Data Error")}var a,i,s=[{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.992452562495,scale:4622324.434309},{level:8,resolution:611.4962262813797,scale:2311162.217155},{level:9,resolution:305.74811314055756,scale:1155581.108577},{level:10,resolution:152.87405657041106,scale:577790.554289},{level:11,resolution:76.43702828507324,scale:288895.277144},{level:12,resolution:38.21851414253662,scale:144447.638572},{level:13,resolution:19.10925707126831,scale:72223.819286},{level:14,resolution:9.554628535634155,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.388657133974685,scale:9027.977411},{level:17,resolution:1.1943285668550503,scale:4513.988705},{level:18,resolution:.5971642835598172,scale:2256.994353},{level:19,resolution:.29858214164761665,scale:1128.497176}];try{require(["dojo/_base/Color","dojo/dom-construct"],function(e,r){var t=new y({fillSymbol:new g(g.STYLE_SOLID,new m(m.STYLE_SOLID,new e([255,0,0]),2),new e([255,255,0,.25]))},r.create("div"));map=new o("mapDiv",{autoResize:!0,extent:initExtent,showAttribution:!1,logo:!1,infoWindow:t,isRubberBandZoom:!0,isScrollWheelZoom:!0,isShiftDoubleClick:!0,displayGraphicsOnPan:!O("ie"),sliderStyle:"large",basemap:"streets",minScale:9244649,lods:s})})}catch(e){alert("Error creating map in readConfig.js. "+e.message,"Code Error",e)}map.on("layer-add-result",function(e){var r,t;try{if(e.error)!0,alert("Problem adding layer to map: "+e.layer.url+". Reason: "+e.error.message+". At javascript/readConfig.js","Code Error");else if(e.layer.url&&e.layer.url.indexOf("MVUM")>-1)for(t=0;t<e.layer.layerInfos.length;t++)"Visitor Map Symbology"==e.layer.layerInfos[t].name?e.layer.layerInfos[t].defaultVisibility=!1:"Status"==e.layer.layerInfos[t].name&&(e.layer.layerInfos[t].defaultVisibility=!1)}catch(r){alert("Error loading layer, "+e.layer.id+", to map. Reason: "+r.message+" in javascript/readConfig.js layer-add-result","Code Error",r)}var l=!1;for(r=0;r<legendLayers.length;r++)if(e.layer.id===legendLayers[r].title){l=!0;break}if(l){var s=!0;for(r=0;r<S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer").length;r++)0==C[S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[r].getAttribute("label")]&&(s=!1);if(s){var n=[],o=[];for(r=0;r<legendLayers.length;r++)n[r]=Object.assign({},legendLayers[r]);var d=0;for(r=0;r<map.layerIds.length;r++)o[r]=Object.assign({},map.getLayer(map.layerIds[r])),map.getLayer(map.layerIds[r]).id.indexOf("layer")>-1&&d++;var y=0;for(r=0;r<S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer").length;r++){for(t=0;t<legendLayers.length;t++)if(n[t].title===S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[r].getAttribute("label")){legendLayers[y++]=Object.assign({},n[t]);break}for(var g=0;g<o.length;g++)if(o[g].id===S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[r].getAttribute("label")){map.reorderLayer(Object.assign({},o[g]),r+d);break}}legendLayers.reverse()}try{if(a){if(i.checked)for(var u=0;u<a.layerInfos.length;u++)a.layerInfos[u].noLegend=!1;return a.refresh(),void a._adjustToState()}a=new p({map:map,layerInfos:legendLayers},"tocDiv"),a.startup(),i=new c({name:"showLegendChkBox",onChange:function(){require(["dijit/registry"],function(e){try{var r=document.getElementById("tocLoading");r.style.display="block",r.style.visibility="visible";var t=!0,a=e.byId("tocDiv");i.checked?(t=!1,setCookie("legend","1")):setCookie("legend","0");for(var l=0;l<a._rootLayerTOCs.length;l++)a._rootLayerTOCs[l].config.noLegend=t;a.refresh(),a._adjustToState(),setTimeout(function(){r.style.display="none",r.style.visibility="hidden"},1e3)}catch(e){alert("Error in readConfig.js. Loading click event for Show Legend checkbox. "+e.message,"Code Error",e),hideLoading()}})}},"showLegendChkBox"),i.startup(),1==getCookie("legend")&&i.set("checked",!0)}catch(e){alert("Error loading TOC Map Layers & Legend: "+e.message+" in javascript/readConfig.js or toc/src/agsjs/dijit/TOC.js","Code Error",e)}if(!P){P=!0;try{readSettingsWidget()}catch(e){alert("Error reading SettingsWidget.xml. Reason: "+e.message+" in javascript/readConfig.js","SettingsWidget Error",e)}try{I()}catch(e){alert("Error loading graphics and labels from the URL: "+e.message+" in javascript/readConfig.js","URL Graphics Error",e)}}}}),map.on("load",function(){map.on("mouse-move",showCoordinates),map.on("mouse-drag",showCoordinates),map.on("update-start",showLoading),map.on("update-end",hideLoading),require(["esri/dijit/Scalebar"],function(e){new e({map:map,scalebarUnit:"dual"})}),map.on("click",doIdentify),map.on("extent-change",showMapScale),document.getElementById("mapscaleList").selectedIndex=map.getLevel(),q(),addOverviewMap(),T()})}else 404===_.status?(alert("Error: Missing config.xml file in "+app+" directory.","Data Error"),hideLoading()):4===_.readyState&&500===_.status&&(alert("Make sure your application name is correct on the URL. app="+app,"Warning"),hideLoading())},_.open("GET",U,!0),_.send(null)}catch(e){alert("Error in javascript/readConfig.js. "+e.message,"Code Error",e)}})}var locator,layerObj,addressGraphicsCount=[],addressGraphicsCounter=0,overviewOpen=!1;