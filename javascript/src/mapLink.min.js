function setMapLink(){var e;"function"==typeof ga&&ga("send","event","map_link","click","Map Link","1"),"function"==typeof gtag&&gtag("event","widget_click",{widget_name:"Map Link"});var t=window.location.href,n=t.split("&"),a=n[0];-1==a.indexOf("index.html")&&(a+="index.html?app=huntingatlas"),-1==a.indexOf("app")&&(a+="?app=huntingatlas");for(var r=1;r<n.length;r++)-1==n[r].indexOf("extent")&&-1==n[r].indexOf("prj")&&-1==n[r].indexOf("point")&&-1==n[r].indexOf("poly")&&-1==n[r].indexOf("text")&&-1==n[r].indexOf("rect")&&-1==n[r].indexOf("line")&&-1==n[r].indexOf("hb1298")&&-1==n[r].indexOf("layer")&&(a+="&"+n[r]);e=a.length,a+="&prj="+wkid,a+=mlGetExtent(),document.getElementById("mapLinkTxt").value=a,document.getElementById("extMLckb").checked=!0,document.getElementById("extMLckb").disabled=!1,document.getElementById("extMapLinkLen").value=a.length-e,e=a.length;var o=mlGetPoints();o||(o=""),"function"==typeof getHB1298Points&&(o+=getHB1298Points()),o&&""!=o?(a+=o,document.getElementById("ptMLckb").checked=!0,document.getElementById("ptMLckb").disabled=!1,document.getElementById("ptMLtxt").style.color="#000",document.getElementById("ptMapLinkLen").value=a.length-e,e=a.length):(document.getElementById("ptMLckb").disabled=!0,document.getElementById("ptMLtxt").style.color="#ccc");var l=mlGetPolys();l?(a+=l,document.getElementById("polyMLckb").checked=!0,document.getElementById("polyMLckb").disabled=!1,document.getElementById("polyMLtxt").style.color="#000",document.getElementById("polyMapLinkLen").value=a.length-e,e=a.length):(document.getElementById("polyMLckb").disabled=!0,document.getElementById("polyMLtxt").style.color="#ccc"),drawTextGraphicsCount.length>0?(a+=mlGetText(),document.getElementById("txtMLckb").checked=!0,document.getElementById("txtMLckb").disabled=!1,document.getElementById("txtMLtxt").style.color="#000",document.getElementById("txtMapLinkLen").value=a.length-e,e=a.length):(document.getElementById("txtMLckb").disabled=!0,document.getElementById("txtMLtxt").style.color="#ccc");var i=mlGetLines();i?(a+=i,document.getElementById("lineMLckb").checked=!0,document.getElementById("lineMLckb").disabled=!1,document.getElementById("lineMLtxt").style.color="#000",document.getElementById("lineMapLinkLen").value=a.length-e,e=a.length):(document.getElementById("lineMLckb").disabled=!0,document.getElementById("lineMLtxt").style.color="#ccc"),a+=mlGetLayers(),document.getElementById("layMLckb").checked=!0,document.getElementById("layMLckb").disabled=!1,document.getElementById("layMLtxt").style.color="black",document.getElementById("layMapLinkLen").value=a.length-e,e=a.length;var m=mlGetRect();m?(a+=m,document.getElementById("rectMLckb").checked=!0,document.getElementById("rectMLckb").disabled=!1,document.getElementById("rectMLtxt").style.color="#000",document.getElementById("rectMapLinkLen").value=a.length-e,e=a.length):(document.getElementById("rectMLckb").disabled=!0,document.getElementById("rectMLtxt").style.color="#ccc"),a=a.replace(/ /g,"%20"),document.getElementById("mapLinkLen").value=a.length,document.getElementById("mapLinkTxt").value=a,a.length>2048?document.getElementById("mapLinkWarning").style.display="block":document.getElementById("mapLinkWarning").style.display="none",document.getElementById("mapLinkTxt").focus(),mapLinkDialog.show()}function mlGetExtent(){return"&extent="+parseInt(map.extent.xmin)+","+parseInt(map.extent.ymin)+","+parseInt(map.extent.xmax)+","+parseInt(map.extent.ymax)}function mlGetText(){for(var e=null,t=/'/g,n=/"/g,a=0;a<drawTextGraphicsCount.length;a++){var r=map.getLayer(drawTextGraphicsCount[a]).graphics[0];a>0?e+=",":e="&text=";var o=r.symbol.text.replace(t,"\\%27").replace(n,"\\%22").replace(/,/g,";");e+=parseInt(r.geometry.x)+"|"+parseInt(r.geometry.y)+"|"+o+"|0|"+parseInt(r.symbol.font.size)+"|0|t|f|f"}return e}function mlGetPoints(){for(var e=null,t=/'/g,n=/"/g,a=0;a<drawGraphicsCount.length;a++){var r=map.getLayer(drawGraphicsCount[a]).graphics[0];if("point"==r.geometry.type){e||(e="&point="),"&point="!=e&&(e+=",");var o=r.symbol.color.toRgb(),l="m";7==r.symbol.size?l="s":21==r.symbol.size&&(l="l");var i="y";255==o[0]?i="r":255==o[1]?i="g":255==o[2]&&(i="b"),e+=l+"|"+i+"|"+parseInt(r.geometry.x)+"|"+parseInt(r.geometry.y),map.getLayer(drawGraphicsCount[a]).graphics[1]&&(r=map.getLayer(drawGraphicsCount[a]).graphics[1].symbol.text,e+="|"+r.replace(t,"\\%27").replace(n,"\\%22").replace(/,/g,";"))}}return e}function mlGetLines(){for(var e=null,t=/'/g,n=/"/g,a=0;a<drawGraphicsCount.length;a++){var r=map.getLayer(drawGraphicsCount[a]).graphics[0];if("polyline"==r.geometry.type){e||(e="&line="),"&line="!=e&&(e+=",");var o=r.symbol.color.toRgb();for(e+="solid|"+o[0]+";"+o[1]+";"+o[2]+"|1|2|"+r.geometry.paths.length,j=0;j<r.geometry.paths.length;j++)for(e+="|"+r.geometry.paths[j].length,k=0;k<r.geometry.paths[j].length;k++)e+="|"+parseInt(r.geometry.paths[j][k][0])+"|"+parseInt(r.geometry.paths[j][k][1]);map.getLayer(drawGraphicsCount[a]).graphics[1]&&(r=map.getLayer(drawGraphicsCount[a]).graphics[1],e+="|"+parseInt(r.geometry.x)+"|"+parseInt(r.geometry.y)+"|"+r.symbol.text.replace(t,"\\%27").replace(n,"\\%22").replace(/,/g,";")+"|0|"+parseInt(r.symbol.font.size)+"|0|t|f|f"),o=null}}return e}function mlGetPolys(){for(var e=null,t=/'/g,n=/"/g,a=0;a<drawGraphicsCount.length;a++){var r=map.getLayer(drawGraphicsCount[a]).graphics[0];if("polygon"==r.geometry.type){var o=r.geometry.getExtent(),l=[o.xmin,o.xmax,o.ymin,o.ymax],i=!0;for(j=0;j<r.geometry.rings[0].length;j++){if(-1==l.indexOf(r.geometry.rings[0][j][0])){i=!1;break}if(-1==l.indexOf(r.geometry.rings[0][j][1])){i=!1;break}}if(!i){e||(e="&poly="),"&poly="!=e&&(e+=",");var m=r.symbol.color.toRgba(),s=r.symbol.outline.color.toRgb();for(e+=r.symbol.style+"|"+m[0]+";"+m[1]+";"+m[2]+";"+m[3]+"|-1|solid|"+s[0]+";"+s[1]+";"+s[2]+"|"+r.symbol.outline.width+"|"+r.geometry.rings.length,j=0;j<r.geometry.rings.length;j++)for(e+="|"+r.geometry.rings[j].length,k=0;k<r.geometry.rings[j].length;k++)e+="|"+parseInt(r.geometry.rings[j][k][0])+"|"+parseInt(r.geometry.rings[j][k][1]);map.getLayer(drawGraphicsCount[a]).graphics[1]&&(r=map.getLayer(drawGraphicsCount[a]).graphics[1],e+="|"+parseInt(r.geometry.x)+"|"+parseInt(r.geometry.y)+"|"+r.symbol.text.replace(t,"\\%27").replace(n,"\\%22").replace(/,/g,";")+"|0|"+parseInt(r.symbol.font.size)+"|0|t|f|f"),m=null,s=null}}}return e}function mlGetRect(){for(var e=null,t=/'/g,n=/"/g,a=0;a<drawGraphicsCount.length;a++){var r=map.getLayer(drawGraphicsCount[a]).graphics[0];if("polygon"==r.geometry.type){var o=r.geometry.getExtent(),l=[o.xmin,o.xmax,o.ymin,o.ymax],i=!0;for(j=0;j<r.geometry.rings[0].length;j++){if(-1==l.indexOf(r.geometry.rings[0][j][0])){i=!1;break}if(-1==l.indexOf(r.geometry.rings[0][j][1])){i=!1;break}}if(i){e||(e="&rect="),"&rect="!=e&&(e+=",");var m=r.symbol.color.toRgba(),s=r.symbol.outline.color.toRgb();for(e+=r.symbol.style+"|"+m[0]+";"+m[1]+";"+m[2]+";"+m[3]+"|-1|solid|"+s[0]+";"+s[1]+";"+s[2]+"|"+r.symbol.outline.width,j=0;j<r.geometry.rings.length;j++)for(k=0;k<r.geometry.rings[j].length;k++)e+="|"+parseInt(r.geometry.rings[j][k][0])+"|"+parseInt(r.geometry.rings[j][k][1]);map.getLayer(drawGraphicsCount[a]).graphics[1]&&(r=map.getLayer(drawGraphicsCount[a]).graphics[1],e+="|"+parseInt(r.geometry.x)+"|"+parseInt(r.geometry.y)+"|"+r.symbol.text.replace(t,"\\%27").replace(n,"\\%22").replace(/,/g,";")+"|0|"+parseInt(r.symbol.font.size)+"|0|t|f|f"),m=null,s=null}}}return e}function mlGetLayers(){for(var e="&layer="+mapBasemap+"|",t=map.getLayersVisibleAtScale(),n=0;n<t.length;n++)if("esri.layers.ArcGISDynamicMapServiceLayer"==t[n].declaredClass){if(!t[n].visible)continue;"|"!=e.substring(e.length-1,e.length)&&(e+=",");var a=t[n].opacity.toString();e+=t[n].id+"|"+a.substring(0,4)+"|";for(var r=0;r<t[n].layerInfos.length;r++)if(-1!=t[n].visibleLayers.indexOf(r)){for(var o=r;-1!=t[n].layerInfos[o].parentLayerId;)-1==t[n].visibleLayers.indexOf(t[n].layerInfos[o].parentLayerId)&&t[n].visibleLayers.push(t[n].layerInfos[o].parentLayerId),o=t[n].layerInfos[o].parentLayerId;t[n].visibleLayers=t[n].visibleLayers.sort(function(e,t){return e-t})}for(var l=0;l<t[n].visibleLayers.length;l++)0!=l&&(e+="-"),e+=t[n].visibleLayers[l]}return e}function mlCheckbox(e,t){var n=document.getElementById("mapLinkTxt").value,a="";if(e.checked)if("extent"==t)a=n+mlGetExtent();else if("layer"==t)a=n+mlGetLayers();else if("text"==t)a=n+mlGetText();else if("point"==t){var r=mlGetPoints();r||(r=""),a=n+r,"function"==typeof getHB1298Points&&(a+=getHB1298Points())}else"line"==t?a=n+mlGetLines():"poly"==t?a=n+mlGetPolys():"rect"==t&&(a=n+mlGetRect());else for(var o=n.split("&"),l=0;l<o.length;l++)-1==o[l].indexOf(t)&&(""!=a&&(a+="&"),a+=o[l]);a.length>2048?document.getElementById("mapLinkWarning").style.display="block":document.getElementById("mapLinkWarning").style.display="none",document.getElementById("mapLinkTxt").value=a,document.getElementById("mapLinkLen").value=a.length,document.getElementById("mapLinkTxt").focus()}function showMapExtent(){require(["esri/geometry/Point","esri/geometry/webMercatorUtils"],function(e,t){function n(e,t){require(["esri/tasks/ProjectParameters","esri/geometry/Extent","esri/SpatialReference"],function(n,a,r){var o=new n;o.geometries=[new a(map.extent.xmin,map.extent.ymin,map.extent.xmax,map.extent.ymax,new r({wkid:wkid}))],o.outSR=new r(Number(e)),geometryService.project(o,function(e){alert(e[0].xmin.toFixed(0)+", "+e[0].ymin.toFixed(0)+", "+e[0].xmax.toFixed(0)+", "+e[0].ymax.toFixed(0)+" <br/>in "+t+"<p>Note: Coordinate format can be changed in Settings.</p>","Current Map Extent"),o=null},function(e){alert("Problem projecting points. Can't display extent. Error message: "+e.message,"Warning"),o=null})})}var a,r;switch(settings.XYProjection){case"dd":a=t.webMercatorToGeographic(new e(map.extent.xmin,map.extent.ymin,wkid)),r=t.webMercatorToGeographic(new e(map.extent.xmax,map.extent.ymax,wkid)),alert(a.x.toFixed(5)+", "+a.y.toFixed(5)+", "+r.x.toFixed(5)+", "+r.y.toFixed(5)+" <br/>in decimal degrees<p>Note: Coordinate format can be changed in Settings.</p>","Current Map Extent");break;case"dms":a=mappoint_to_dms(new e(map.extent.xmin,map.extent.ymin,wkid),!1),r=mappoint_to_dms(new e(map.extent.xmax,map.extent.ymax,wkid),!1),alert(a[0]+", "+a[1]+", "+r[0]+", "+r[1]+" <br/>in degrees, minutes, seconds<p>Note: Coordinate format can be changed in Settings.</p>","Current Map Extent");break;case"dm":a=mappoint_to_dm(new e(map.extent.xmin,map.extent.ymin,wkid),!1),r=mappoint_to_dm(new e(map.extent.xmax,map.extent.ymax,wkid),!1),alert(a[0]+", "+a[1]+", "+r[0]+", "+r[1]+" <br/>in degrees, decimal minutes<p>Note: Coordinate format can be changed in Settings.</p>","Current Map Extent");break;case"32612":n(32612,"WGS84 UTM Zone 12N");break;case"32613":n(32613,"WGS84 UTM Zone 13N");break;case"26912":n(26912,"NAD83 UTM Zone 12N");break;case"26913":n(26913,"NAD83 UTM Zone 13N");break;case"26712":n(26712,"NAD27 UTM Zone 12N");break;case"26713":n(26713,"NAD27 UTM Zone 13N")}})}