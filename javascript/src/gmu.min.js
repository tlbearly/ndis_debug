function showGMUCombo(e,o){try{if(gmu_combo=gmu,gmu_field=o,gmu_url=e,!gmu_url||!gmu_field)return void alert("Missing gmu_url or gmu_field tag in SettingsWidget.xml.  This must be set when use_gmus is true.","Data Error");require(["esri/tasks/query","esri/tasks/QueryTask"],function(e,o){try{var t=new o(gmu_url),r=new e;r.returnGeometry=!1,r.outFields=[gmu_field],"Goat GMU"==gmu_combo||"Bighorn GMU"==gmu_combo?(r.where="'"+gmu_field+"' <> ''",r.outFields.push("HUNTING")):r.where=gmu_field+" <> -1",t.execute(r,showResults,onLoadFault),t=null}catch(e){alert("Error occured while trying to show the GMU drop down: "+e.message+" in javascript/gmu.js showGMUCombo().","Code Error",e)}})}catch(e){alert("Error occured while trying to show the GMU drop down: "+e.message+" in javascript/gmu.js showGMUCombo().","Code Error",e)}}function onLoadFault(e){hideLoading(),alert(e.message+" Error querying url, "+gmu_url+", for field, "+gmu_field+", in javascript/gmu.js ShowGMUCombo()","Data Error")}function showResults(e){try{require(["dijit/form/ComboBox","dojo/store/Memory","esri/tasks/query","esri/tasks/QueryTask"],function(o,t,r,u){var i,s=[],n=[],a=[];for(i=0;i<e.features.length;i++)("Goat GMU"!=gmu_combo&&"Bighorn GMU"!=gmu_combo||"YES"==e.features[i].attributes.HUNTING)&&s.push(e.features[i].attributes[gmu_field]);if("Big Game GMU"==gmu)s.sort(function(e,o){return e-o});else{var m="G";"Bighorn GMU"==gmu&&(m="S"),s.forEach(function(e){"OUT"!=e&&e.substring(1)&&a.push(e.substring(1))}),a.sort(function(e,o){return e-o}),s=[],a.forEach(function(e){s.push(m+e)})}for(i=0;i<s.length;i++)n.push({gmuid:s[i]});var g=document.getElementById("gmuDiv"),l=new o({id:"gmuList",placeHolder:"Unit",store:new t({data:n}),autoComplete:!0,maxHeight:300,searchAttr:"gmuid",style:"width: 60px;",onClick:function(){if(gmu!=gmu_combo){showLoading(),reloadGMUCombo=!0,"Bighorn GMU"==gmu?showGMUCombo(settings.sheepUrl,settings.sheepField):"Big Game GMU"==gmu?showGMUCombo(settings.elkUrl,settings.elkField):"Goat GMU"==gmu&&showGMUCombo(settings.goatUrl,settings.goatField),l&&l.destroy();var e=document.createElement("span");e.id="gmuCombo",g.appendChild(e)}},onChange:function(e){if(""!=e){showLoading(),this.reset();var o=new u(gmu_url);query=new r,query.returnGeometry=!0,query.outFields=[gmu_field],"Goat GMU"==gmu_combo||"Bighorn GMU"==gmu_combo?(query.where=gmu_field+" = '"+e+"'",query.outFields.push("HUNTING")):query.where=gmu_field+" = "+e,o.execute(query,onResult,onFault),o=null}},required:!1},"gmuCombo");l.startup(),g.style.display="block",reloadGMUCombo&&(hideLoading(),l.loadAndOpenDropDown(),reloadGMUCombo=!1),s=null,n=null,a=null})}catch(e){alert(e.message+" in javascript/gmu.js showResults().","Code Error",e)}}function onResult(e){return 0==e.features.length?(alert("No GMU area found by that name.","Warning"),void hideLoading()):"Goat GMU"!=gmu_combo&&"Bighorn GMU"!=gmu_combo||"YES"==e.features[0].attributes.HUNTING?(map.setExtent(new esri.graphicsExtent(e.features),!0),void hideLoading()):(alert("Hunting is not allowed at this location. Please select from drop down menu."),void hideLoading())}function onFault(e){hideLoading(),alert("No GMU area found by that name.","Warning")}var gmu_field,gmu_url,gmu_combo,reloadGMUCombo=!1;