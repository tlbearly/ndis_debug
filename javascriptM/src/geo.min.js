function geo_success(e){e.coords.accuracy<=min_accuracy?prev_lat.toFixed(5)==e.coords.latitude.toFixed(5)&&prev_long==e.coords.longitude.toFixed(5)||(prev_lat=e.coords.latitude,prev_long=e.coords.longitude,displayLocation(e)):(wpid=!1,"0px"==document.getElementById("menuView").style.left&&(alert("Accuracy not sufficient (+/-"+Math.round(e.coords.accuracy,1).numberFormat(0)+"m) for current location.",""),document.getElementById("LocateButton").className=""))}function displayLocation(e){require(["esri/layers/GraphicsLayer","esri/geometry/Point","esri/symbols/PictureMarkerSymbol","esri/graphic","esri/geometry/webMercatorUtils"],function(o,t,a,c,n){try{locGraphicsLayer||(locGraphicsLayer=new o,map.addLayer(locGraphicsLayer),locSymbol=new a("assets/images/bluedot.png",20,20)),locGraphicsLayer.clear();var r=n.geographicToWebMercator(new t(e.coords.longitude,e.coords.latitude));lastPoint||map.centerAndZoom(r,7),locGraphicsLayer.add(new c(r,locSymbol)),lastPoint=r}catch(e){document.getElementById("LocateButton").className="",alert(e.message,"Error",e)}})}function geo_error(e){switch(e.code){case e.PERMISSION_DENIED:wpid>0&&alert("You have blocked this site from accessing your location. <button data-dojo-type='dojox/mobile/Button' class='mblButton' onclick=\"slideRight(document.getElementById('locationHelp'));closeAlert();document.getElementById('errorMsg').innerHTML=''\">Help</button>",""),navigator.geolocation.clearWatch(wpid),wpid=!1,document.getElementById("LocateButton").className="";break;case e.POSITION_UNAVAILABLE:case e.TIMEOUT:wpid>0&&alert("Could not determine your location. <button data-dojo-type='dojox/mobile/Button' class='mblButton' onclick=\"slideRight(document.getElementById('locationHelp'));closeAlert();document.getElementById('errorMsg').innerHTML=''\">Help</button>",""),document.getElementById("LocateButton").className="",navigator.geolocation.clearWatch(wpid),wpid=!1}}function get_pos(){navigator.geolocation?wpid=navigator.geolocation.watchPosition(geo_success,geo_error,{enableHighAccuracy:!0,maximumAge:3e4,timeout:27e3}):(alert("Your Browser doesn't support the Geo Location API.<br/><input type='checkbox' class='checkBoxButton' onClick='setCookie(\"noGeo\",\"1\");closeAlert();' /> Do not show this again.",""),document.getElementById("LocateButton").className="")}function init_geo(){-1==document.getElementById("LocateButton").className.indexOf("tracking")?(prev_lat=0,prev_long=0,lastPoint=null,document.getElementById("LocateButton").className="tracking",wpid?(navigator.geolocation.clearWatch(wpid),wpid=!1):get_pos()):(document.getElementById("LocateButton").className="",navigator.geolocation.clearWatch(wpid),wpid=!1,locGraphicsLayer&&locGraphicsLayer.clear())}var z,prev_lat,prev_long,locSymbol,wpid=!1,locGraphicsLayer=null,lastPoint=null,min_accuracy=4e3;